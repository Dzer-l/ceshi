{"remainingRequest":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/thread-loader/dist/cjs.js!/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/home/jenkins_data/workspace/页面-公证处后台/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jenkins_data/workspace/页面-公证处后台/src/components/universal/documentMaterial.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jenkins_data/workspace/页面-公证处后台/src/components/universal/documentMaterial.vue","mtime":1634724784698},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyWyJAQGl0ZXJhdG9yIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1siQEBpdGVyYXRvciJdOyBpZiAoIWl0KSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyB0aHJvdyBfZTI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IGl0LmNhbGwobyk7IH0sIG46IGZ1bmN0aW9uIG4oKSB7IHZhciBzdGVwID0gaXQubmV4dCgpOyBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lOyByZXR1cm4gc3RlcDsgfSwgZTogZnVuY3Rpb24gZShfZTMpIHsgZGlkRXJyID0gdHJ1ZTsgZXJyID0gX2UzOyB9LCBmOiBmdW5jdGlvbiBmKCkgeyB0cnkgeyBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXQucmV0dXJuICE9IG51bGwpIGl0LnJldHVybigpOyB9IGZpbmFsbHkgeyBpZiAoZGlkRXJyKSB0aHJvdyBlcnI7IH0gfSB9OyB9CgpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQoKZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CgppbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tICIvaG9tZS9qZW5raW5zX2RhdGEvd29ya3NwYWNlL1x1OTg3NVx1OTc2Mi1cdTUxNkNcdThCQzFcdTU5MDRcdTU0MEVcdTUzRjAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBnZXRVbml2ZXJzYWxEb2N1bWVudCwgLy8g5paH5Lmm5p2Q5paZ5p+l6K+iCmdldFVuaXZlcnNhbE9yZGVyRGV0YWlsLCAvLyDojrflj5borqLljZXor6bmg4UKRGVsZXRlV3JpdE1hdGVyaWFscyB9IGZyb20gJy4uLy4uL2FwaS91bml2ZXJzYWwnOwppbXBvcnQgeyBwcmludEluaXQsIHByaW50IH0gZnJvbSAnLi4vLi4vdXRpbHMvcHJpbnREb2N1bWVudHMnOwppbXBvcnQgc2lnbkZpbGUgZnJvbSAnLi4vLi4vY29tcG9uZW50cy91bml2ZXJzYWwvdXBsb2FkRmlsZS52dWUnOwppbXBvcnQgKiBhcyBkZSBmcm9tICdAL2FwaS9kZWxlZ2F0ZSc7CmltcG9ydCB7IGhpZGVMb2FkaW5nLCBzaG93TG9hZGluZyB9IGZyb20gJ0AvdXRpbHMvbG9hZGluZyc7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogWyJvcmRlck51bSJdLAogIGNvbXBvbmVudHM6IHsKICAgIHNpZ25GaWxlOiBzaWduRmlsZQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvcm1MYWJlbEFsaWduOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgdHlwZTogJycKICAgICAgfSwKICAgICAgZG9jdW1lbnRNYXRlcmlhbFRhYmxlRGF0YTogW10sCiAgICAgIGZpbGVTaG93TGlzdERhdGE6IFtdLAogICAgICBjdXJyZW50UGFnZTM6IDEsCiAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgdG90YWw6IDEwMCwKICAgICAgdXBsb2FkTWF0ZXJpYWxEaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgaHR0cDogJycsCiAgICAgIG9yZGVySWQ6ICcnLAogICAgICBpZnJhbWVTdGE6IGZhbHNlLAogICAgICBzdGFEYXRhOiB7fSwKICAgICAgZmlsZVNpZ25MaXN0OiBbXSwKICAgICAgZG9jSW5mbzoge30sCiAgICAgIHNpZ25Cb3hTaG93OiBmYWxzZSwKICAgICAgZmxpZUxpc3Q6IFtdLAogICAgICB1cEZpbGVMaXN0OiBbXSwKICAgICAganVyaXNkaWN0aW9uOiBmYWxzZSwKICAgICAgdHlwZTogJycsCiAgICAgIGZpbGVTaG93OiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkub3JkZXJJZCkgewogICAgICB0aGlzLm9yZGVySWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcmRlcklkOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5vcmRlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUuYXBwLm9yZGVySWQ7CiAgICAgIHZhciB1cmwgPSAiLyMiLmNvbmNhdCh0aGlzLiRyb3V0ZS5wYXRoLCAiP29yZGVySWQ9IikuY29uY2F0KHRoaXMub3JkZXJJZCk7CiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIHVybCk7CiAgICB9CgogICAgdmFyIGRhdGEgPSB7CiAgICAgIHBhZ2VOdW06IHRoaXMuY3VycmVudFBhZ2UzLAogICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkCiAgICB9OwogICAgdGhpcy5nZXRMaXN0KGRhdGEpOwogICAgdGhpcy5qdXJpc2RpY3Rpb24gPSB0aGlzLiRwYXJlbnQuJHBhcmVudC4kcGFyZW50Lmp1cmlzZGljdGlvbjsKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgIHZhciBkYXRhID0gewogICAgICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZAogICAgICB9OwogICAgICB0aGlzLmdldExpc3QoZGF0YSk7IC8vIHRoaXMuZ2V0T3JkZXJJbmZvKCkKCiAgICAgIHRoaXMuc2lnbkJveFNob3cgPSBmYWxzZTsKICAgICAgdGhpcy51cGxvYWRNYXRlcmlhbERpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgidXBkYXRlRGF0YSIpOwogICAgfSwKICAgIGdldExpc3Q6IGZ1bmN0aW9uIGdldExpc3QoZGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy8g5paw55qECiAgICAgIGdldFVuaXZlcnNhbERvY3VtZW50KGRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcywgJ+aWh+S5puadkOaWmeS/oeaBrycpCiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHJlcy5kYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgaWYgKHJlcy5kYXRhW2luZGV4XS5hZnRlclNpZ25GaWxlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJlcy5kYXRhW2luZGV4XS5hZnRlclNpZ25GaWxlID0gSlNPTi5wYXJzZShyZXMuZGF0YVtpbmRleF0uYWZ0ZXJTaWduRmlsZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5kb2N1bWVudE1hdGVyaWFsVGFibGVEYXRhID0gcmVzLmRhdGE7CiAgICAgICAgX3RoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbDsKICAgICAgICBnZXRVbml2ZXJzYWxPcmRlckRldGFpbChkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcywgJ+WfuuacrOS/oeaBrycpCiAgICAgICAgICBfdGhpcy5zdGFEYXRhID0gcmVzLmRhdGE7IC8vIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tcHlmLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScsIHRoaXMuc3RhRGF0YSkKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlU2l6ZUNoYW5nZTogZnVuY3Rpb24gaGFuZGxlU2l6ZUNoYW5nZSgpIHsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgcGFnZU51bTogdGhpcy5jdXJyZW50UGFnZTMsCiAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsCiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkCiAgICAgIH07CiAgICAgIHRoaXMuZ2V0TGlzdChkYXRhKTsKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVDdXJyZW50Q2hhbmdlKCkgewogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICBwYWdlTnVtOiB0aGlzLmN1cnJlbnRQYWdlMywKICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQKICAgICAgfTsKICAgICAgdGhpcy5nZXRMaXN0KGRhdGEpOwogICAgfSwKICAgIHVwbG9hZE1hdGVyaWFsOiBmdW5jdGlvbiB1cGxvYWRNYXRlcmlhbCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIuc3RhRGF0YS5vcmRlclN0YXR1cyA9PSAzMDYpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuaGFuZGxlQ29tZmlybSgi5b2T5YmN6K6i5Y2V5bey5a6M5oiQ77yM6YeN5paw5LiK5Lyg562+572y5paH5Lu277yM5bCG5riF56m65omA5pyJ5bey562+572y5paH5Lu255qE562+5ZCN77yM6ZyA6KaB6YeN5paw562+572y77yM56Gu5a6a57un57ut5pON5L2c5ZCX77yfIikuY2F0Y2goZnVuY3Rpb24gKGVycikge30pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfdGhpczIudXBsb2FkTWF0ZXJpYWxEaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF90aGlzMi5maWxlU2hvd0xpc3REYXRhID0gW107CiAgICAgICAgICAgICAgICBfdGhpczIuZmlsZVNob3cgPSBbXTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIOaPkOekugogICAgaGFuZGxlQ29tZmlybTogZnVuY3Rpb24gaGFuZGxlQ29tZmlybShtZXNzYWdlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBfdGhpczMuJGNvbmZpcm0oIjxwIHN0eWxlPVwiY29sb3I6cmVkO1wiPiIuY29uY2F0KG1lc3NhZ2UsICI8L3A+IiksICfmk43kvZzmj5DnpLonLCB7CiAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsCiAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgcmVqZWN0KGZhbHNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gZWRpdERvY3VtZW50KHZhbCkgewogICAgLy8gCXRoaXMuaWZyYW1lU3RhID0gdHJ1ZQogICAgLy8gCWNvbnN0IG1vZGUgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfTU9ERQogICAgLy8gCWNvbnNvbGUubG9nKG1vZGUpCiAgICAvLyAJaWYgKG1vZGUgPT09ICdkZXZlbG9wbWVudCcpIHsKICAgIC8vIAkJdGhpcy5odHRwID0gJ2h0dHA6Ly8xOTIuMTY4LjEuMTg2OjEyMDA5JwogICAgLy8gCX0gZWxzZSBpZiAobW9kZSA9PT0gJ3Rlc3QnKSB7CiAgICAvLyAJCXRoaXMuaHR0cCA9ICdodHRwczovL3Rlc3Qtb25seW9mZmljZS5sdnpoZW5neXVuLmNuJwogICAgLy8gCX0gZWxzZSBpZiAobW9kZSA9PT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAvLyAJCXRoaXMuaHR0cCA9ICdodHRwczovL29mZmljZS5sdnpoZW5neXVuLmNuJwogICAgLy8gCX0gZWxzZSBpZiAobW9kZSA9PT0gJ3N0YWdpbmcnKSB7CiAgICAvLyAJCXRoaXMuaHR0cCA9ICdodHRwczovL3Rlc3Qtb25seW9mZmljZS5sdnpoZW5neXVuLmNuJwogICAgLy8gCX0KICAgIC8vIAkvLyBjb25zb2xlLmxvZyh2YWwpOwogICAgLy8gCXdpbmRvdy5vcGVuKGAke3RoaXMuaHR0cH0vcGFnZS9nby1vcGVuLW9yZGVyLWRvY21lbnQvJHt2YWwub3JkZXJJZH0vJHt2YWwuaWR9YCwgJ3Rlc3QnKQogICAgLy8gCS8vIHdpbmRvdy5vcGVuKAogICAgLy8gCS8vICAgYGh0dHBzOi8vdGVzdC1vbmx5b2ZmaWNlLmx2emhlbmd5dW4uY24vcGFnZS9nby1vcGVuLW9yZGVyLWRvY21lbnQvJHt2YWwub3JkZXJJZH0vJHt2YWwuaWR9YCwKICAgIC8vIAkvLyAgICd0ZXN0JwogICAgLy8gCS8vICkKICAgIC8vIH0sCiAgICBzaW5nbGVEb3dubG9hZDogZnVuY3Rpb24gc2luZ2xlRG93bmxvYWQodmFsKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIGZpbGVOYW1lID0gJyc7CgogICAgICBpZiAodmFsLmFmdGVyU2lnbkZpbGUgIT0gbnVsbCkgewogICAgICAgIGZpbGVOYW1lID0gdmFsLmFmdGVyU2lnbkZpbGUub3JpZ2luYWxGaWxlbmFtZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWxlTmFtZSA9IEpTT04ucGFyc2UodmFsLmJlZm9yZVNpZ25GaWxlKS5vcmlnaW5hbEZpbGVuYW1lOwogICAgICB9CgogICAgICBjb25zb2xlLmxvZyhmaWxlTmFtZSk7CiAgICAgIHZhciBkb3dubG9hZFR5cGUgPSAxOwogICAgICB0aGlzLiRheGlvcygnb3JnL2FjY2VwdGFuY2UtZG93bmxvYWQtbWF0ZXJpYWwnLCB7CiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgIGRvY3VtZW50SWQ6IHZhbC5pZCwKICAgICAgICBkb3dubG9hZFR5cGU6IGRvd25sb2FkVHlwZQogICAgICB9LCB7CiAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicKICAgICAgfSkudGhlbihmdW5jdGlvbiAoYmxvYikgewogICAgICAgIGNvbnNvbGUubG9nKGJsb2IpOwoKICAgICAgICBfdGhpczQuc2F2ZUFzKGJsb2IsIGZpbGVOYW1lKTsKICAgICAgfSk7CiAgICB9LAogICAgZGVsZXRlTWF0ZXJpYWxzOiBmdW5jdGlvbiBkZWxldGVNYXRlcmlhbHModmFsKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczUuc3RhRGF0YS5vcmRlclN0YXR1cyA9PSAzMDYpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5oYW5kbGVDb21maXJtKCLlvZPliY3orqLljZXlt7LlrozmiJDvvIzliKDpmaTmlofku7bvvIzlsIbmuIXnqbrmiYDmnInlt7Lnrb7nvbLmlofku7bnmoTnrb7lkI3vvIzpnIDopoHph43mlrDnrb7nvbLvvIznoa7lrprnu6fnu63mk43kvZzlkJfvvJ8iKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7fSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIERlbGV0ZVdyaXRNYXRlcmlhbHMoewogICAgICAgICAgICAgICAgICBpZDogdmFsLmlkCiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmluaXQoKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXM1LiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfmlofku7blt7LliKDpmaQnLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfdGhpczUuJGNvbmZpcm0oJzxwIHN0eWxlPSJjb2xvcjpyZWQ7Ij7liKDpmaTlkI7vvIzmlofku7bkuI3lj6/mgaLlpI3vvIE8L3A+JywgJ+aPkOekuicsIHsKICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLAogICAgICAgICAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUKICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBEZWxldGVXcml0TWF0ZXJpYWxzKHsKICAgICAgICAgICAgICAgICAgICBpZDogdmFsLmlkCiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmluaXQoKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5paH5Lu25bey5Yig6ZmkJywKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBfdGhpczUuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzYXZlQXM6IGZ1bmN0aW9uIHNhdmVBcyhibG9iLCBmaWxlTmFtZSkgewogICAgICBpZiAod2luZG93Lm5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKSB7CiAgICAgICAgbmF2aWdhdG9yLm1zU2F2ZUJsb2IoYmxvYiwgZmlsZU5hbWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIHZhciBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpOwogICAgICAgIGxpbmsuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOyAvLyDliJvlu7rlr7nosaF1cmwKCiAgICAgICAgbGluay5kb3dubG9hZCA9IGZpbGVOYW1lOyAvLyBmaXggRmlyZWZveAoKICAgICAgICBsaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICAgICAgICBsaW5rLmNsaWNrKCk7CiAgICAgICAgYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICAgICAgICB3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpOyAvLyDpgJrov4fosIPnlKggVVJMLmNyZWF0ZU9iamVjdFVSTCgpIOWIm+W7uueahCBVUkwg5a+56LGhCiAgICAgIH0KICAgIH0sCiAgICBhbGxEb3dubG9hZDogZnVuY3Rpb24gYWxsRG93bmxvYWQoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuZG9jdW1lbnRNYXRlcmlhbFRhYmxlRGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIGRvd25sb2FkVHlwZSA9IDE7CiAgICAgICAgdmFyIGFsbERvY3VtZW50ID0gJyc7CgogICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLmRvY3VtZW50TWF0ZXJpYWxUYWJsZURhdGEubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICBhbGxEb2N1bWVudCArPSB0aGlzLmRvY3VtZW50TWF0ZXJpYWxUYWJsZURhdGFbaW5kZXhdLmlkICsgJywnOwogICAgICAgIH0KCiAgICAgICAgYWxsRG9jdW1lbnQgPSBhbGxEb2N1bWVudC5zdWJzdHJpbmcoMCwgYWxsRG9jdW1lbnQubGVuZ3RoIC0gMSk7IC8vIHZhciBmaWxlTmFtZSA9IGAke3RoaXMuc3RhRGF0YS5idXNpbmVzc1R5cGVEZXNjfSR7dGhpcy5zdGFEYXRhLm9yZGVyTnVtfSAke3RoaXMuZ2V0VGltZSgpfS56aXBgCgogICAgICAgIHZhciBmaWxlTmFtZSA9ICJcdTY1ODdcdTRFNjZcdTY3NTBcdTY1OTkgIi5jb25jYXQodGhpcy5vcmRlck51bSwgIi56aXAiKTsKICAgICAgICBjb25zb2xlLmxvZyhhbGxEb2N1bWVudCk7CiAgICAgICAgdGhpcy4kYXhpb3MoJ29yZy9hY2NlcHRhbmNlLWRvd25sb2FkLW1hdGVyaWFsJywgewogICAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgICAgZG9jdW1lbnRJZDogYWxsRG9jdW1lbnQsCiAgICAgICAgICBkb3dubG9hZFR5cGU6IGRvd25sb2FkVHlwZQogICAgICAgIH0sIHsKICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoYmxvYikgewogICAgICAgICAgY29uc29sZS5sb2coYmxvYik7CgogICAgICAgICAgX3RoaXM2LnNhdmVBcyhibG9iLCBmaWxlTmFtZSk7CgogICAgICAgICAgX3RoaXM2LiRlbWl0KCJ1cGRhdGVEYXRhIik7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5rKh5pyJ5Y+v5LiL6L2955qE5paH5LmmJyk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRUaW1lOiBmdW5jdGlvbiBnZXRUaW1lKCkgewogICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgIHZhciBzZXBlcmF0b3IxID0gJy4nOyAvLyDlubTmnIjml6XkuYvpl7TnmoTliIbpmpQKCiAgICAgIHZhciBzZXBlcmF0b3IyID0gJzonOyAvLyDml7bliIbnp5LkuYvpl7TnmoTliIbpmpQKCiAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDEgPCAxMCA/ICcwJyArIChkYXRlLmdldE1vbnRoKCkgKyAxKSA6IGRhdGUuZ2V0TW9udGgoKSArIDE7IC8vIOiOt+WPluaciCzlpoLmnpzlsI/kuo4xMCzliY3pnaLooaXkuKowCgogICAgICB2YXIgc3RyRGF0ZSA9IGRhdGUuZ2V0RGF0ZSgpIDwgMTAgPyAnMCcgKyBkYXRlLmdldERhdGUoKSA6IGRhdGUuZ2V0RGF0ZSgpOyAvLyDojrflj5bml6Us5aaC5p6c5bCP5LqOMTAs5YmN6Z2i6KGl5LiqMAoKICAgICAgdmFyIHN0ckhvdXJzID0gZGF0ZS5nZXRIb3VycygpIDwgMTAgPyAnMCcgKyBkYXRlLmdldEhvdXJzKCkgOiBkYXRlLmdldEhvdXJzKCk7IC8vIOiOt+WPluWwj+aXtizlpoLmnpzlsI/kuo4xMCzliY3pnaLooaXkuKowCgogICAgICB2YXIgc3RyTWludXRlcyA9IGRhdGUuZ2V0TWludXRlcygpIDwgMTAgPyAnMCcgKyBkYXRlLmdldE1pbnV0ZXMoKSA6IGRhdGUuZ2V0TWludXRlcygpOyAvLyDojrflj5bliIYs5aaC5p6c5bCP5LqOMTAs5YmN6Z2i6KGl5LiqMAoKICAgICAgdmFyIHN0clNlY29uZHMgPSBkYXRlLmdldFNlY29uZHMoKSA8IDEwID8gJzAnICsgZGF0ZS5nZXRTZWNvbmRzKCkgOiBkYXRlLmdldFNlY29uZHMoKTsgLy8g6I635Y+W56eSLOWmguaenOWwj+S6jjEwLOWJjemdouihpeS4qjAKCiAgICAgIHZhciBjdXJyZW50ZGF0ZSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArIHNlcGVyYXRvcjEgKyBtb250aCArIHNlcGVyYXRvcjEgKyBzdHJEYXRlICsgJyAnICsgc3RySG91cnMgKyBzZXBlcmF0b3IyICsgc3RyTWludXRlcyArIHNlcGVyYXRvcjIgKyBzdHJTZWNvbmRzOyAvLyDmi7zmjqXkuIDkuIsKCiAgICAgIHJldHVybiBjdXJyZW50ZGF0ZTsgLy8g6L+U5ZueCiAgICB9LAogICAgLy8g5omT5Y2wCiAgICBwcmludEZpbGU6IGZ1bmN0aW9uIHByaW50RmlsZShyb3cpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB0aGlzLiRheGlvcygib3JnL2FjY2VwdGFuY2Utb3JkZXItZG9jdW1lbnQtcHJldmlldy8iLmNvbmNhdChyb3cuaWQpKS50aGVuKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMocmVzKSB7CiAgICAgICAgICB2YXIgaWRzLCBpbWFnZXMsIGksIGltZ1VybDsKICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAoIXJlcy5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZHMgPSByZXMuZGF0YS5kYXRhLmlkczsKICAgICAgICAgICAgICAgICAgaW1hZ2VzID0gW107CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9yZWdlbmVyYXRvclJ1bnRpbWUua2V5cyhpZHMpOwoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgaWYgKChfY29udGV4dDMudDEgPSBfY29udGV4dDMudDAoKSkuZG9uZSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGkgPSBfY29udGV4dDMudDEudmFsdWU7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5nZXRJbWcoaWRzW2ldLCAxKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIGltZ1VybCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgICBpbWFnZXMucHVzaChpbWdVcmwpOwogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIHJldHVybiBwcmludEluaXQoaW1hZ2VzKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICBwcmludCgpOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgX3RoaXM3LiRtZXNzYWdlLmVycm9yKCLmiZPljbDlpLHotKUiKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgfSkpOwoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKSk7CiAgICB9LAogICAgcHJldmlld0ZpbGU6IGZ1bmN0aW9uIHByZXZpZXdGaWxlKGUpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICB0aGlzLiRheGlvcygib3JnL2FjY2VwdGFuY2Utb3JkZXItZG9jdW1lbnQtcHJldmlldy8iLmNvbmNhdChlLmlkKSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChyZXMpIHsKICAgICAgICAgIHZhciBsaXN0LCBpLCBpbWdVcmw7CiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgc2hvd0xvYWRpbmcoKTsKCiAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5kYXRhLnN1Y2Nlc3MgPT09IHRydWUpKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgbGlzdCA9IHJlcy5kYXRhLmRhdGEuaWRzOwogICAgICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfcmVnZW5lcmF0b3JSdW50aW1lLmtleXMobGlzdCk7CgogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICBpZiAoKF9jb250ZXh0NC50MSA9IF9jb250ZXh0NC50MCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaSA9IF9jb250ZXh0NC50MS52YWx1ZTsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM4LmdldEltZyhsaXN0W2ldLCAxKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIGltZ1VybCA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgICBsaXN0W2ldID0gaW1nVXJsOwogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgIF90aGlzOC4kc3RvcmUuY29tbWl0KCdhcHAvQ0hBTkdFX0lNQUdFJywgbGlzdCk7CgogICAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgICAgfSkpOwoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSgpKTsgLy8gZGUuZ2V0RmlsZUltZyh7IGlkOiBlLmlkIH0pLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAvLyAJaWYgKHJlcy5kYXRhLnN1Y2Nlc3MgPT09IHRydWUpIHsKICAgICAgLy8gCQljb25zdCBsaXN0ID0gcmVzLmRhdGEuZGF0YS5pZHMKICAgICAgLy8gCQlmb3IgKGNvbnN0IGkgaW4gbGlzdCkgewogICAgICAvLyAJCQljb25zdCBpbWdVcmwgPSBhd2FpdCB0aGlzLmdldEltZyhsaXN0W2ldLCAxKQogICAgICAvLyAJCQlsaXN0W2ldID0gaW1nVXJsCiAgICAgIC8vIAkJfQogICAgICAvLyAJCXRoaXMuJHN0b3JlLmNvbW1pdCgnYXBwL0NIQU5HRV9JTUFHRScsIGxpc3QpCiAgICAgIC8vIAl9CiAgICAgIC8vIH0pCiAgICB9LAogICAgZ2V0SW1nOiBmdW5jdGlvbiBnZXRJbWcoaWQsIHR5cGUpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHVybDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHVybCA9IHR5cGUgPT09IDEgPyAib3JnL2FjY2VwdGFuY2Utb3JkZXItZG9jdW1lbnQtcHJldmlldy1pbWcvIi5jb25jYXQoaWQpIDogIm9yZy9hY2NlcHRhbmNlLW9yZGVyLXByb3Bvc2VyLW1hdGVyaWFsLXByZXZpZXctaW1nP2lkPSIuY29uY2F0KGlkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczkuJGF4aW9zKHVybCkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9yZWYzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsICdkYXRhOmltYWdlL3BuZztiYXNlNjQsJyArIHJlcy5kYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDMpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDYuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGdldEZpbGVUeXBlOiBmdW5jdGlvbiBnZXRGaWxlVHlwZShmaWxlTmFtZSkgewogICAgICAvLyDlkI7nvIDojrflj5YKICAgICAgdmFyIHN1ZmZpeCA9ICcnOyAvLyDojrflj5bnsbvlnovnu5PmnpwKCiAgICAgIHZhciByZXN1bHQgPSAnJzsKCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIGZsaWVBcnIgPSBmaWxlTmFtZS5zcGxpdCgnLicpOwogICAgICAgIHN1ZmZpeCA9IGZsaWVBcnJbZmxpZUFyci5sZW5ndGggLSAxXTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgc3VmZml4ID0gJyc7CiAgICAgIH0gLy8gZmlsZU5hbWXml6DlkI7nvIDov5Tlm54gZmFsc2UKCgogICAgICBpZiAoIXN1ZmZpeCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgc3VmZml4ID0gc3VmZml4LnRvTG9jYWxlTG93ZXJDYXNlKCk7IC8vIOWbvueJh+agvOW8jwoKICAgICAgdmFyIGltZ2xpc3QgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdibXAnLCAnZ2lmJ107IC8vIOi/m+ihjOWbvueJh+WMuemFjQoKICAgICAgcmVzdWx0ID0gaW1nbGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHN1ZmZpeDsKICAgICAgfSk7CgogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuICdpbWFnZSc7CiAgICAgIH0gLy8g5Yy56YWNdHh0CgoKICAgICAgdmFyIHR4dGxpc3QgPSBbJ3R4dCddOwogICAgICByZXN1bHQgPSB0eHRsaXN0LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbSA9PT0gc3VmZml4OwogICAgICB9KTsKCiAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gJ3R4dCc7CiAgICAgIH0gLy8g5Yy56YWNIGV4Y2VsCgoKICAgICAgdmFyIGV4Y2VsaXN0ID0gWyd4bHMnLCAneGxzeCddOwogICAgICByZXN1bHQgPSBleGNlbGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHN1ZmZpeDsKICAgICAgfSk7CgogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuICdleGNlbCc7CiAgICAgIH0gLy8g5Yy56YWNIHdvcmQKCgogICAgICB2YXIgd29yZGxpc3QgPSBbJ2RvYycsICdkb2N4J107CiAgICAgIHJlc3VsdCA9IHdvcmRsaXN0LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbSA9PT0gc3VmZml4OwogICAgICB9KTsKCiAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gJ3dvcmQnOwogICAgICB9IC8vIOWMuemFjSBwZGYKCgogICAgICB2YXIgcGRmbGlzdCA9IFsncGRmJ107CiAgICAgIHJlc3VsdCA9IHBkZmxpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtID09PSBzdWZmaXg7CiAgICAgIH0pOwoKICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgIHJldHVybiAncGRmJzsKICAgICAgfSAvLyDljLnphY0gcHB0CgoKICAgICAgdmFyIHBwdGxpc3QgPSBbJ3BwdCcsICdwcHR4J107CiAgICAgIHJlc3VsdCA9IHBwdGxpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtID09PSBzdWZmaXg7CiAgICAgIH0pOwoKICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgIHJldHVybiAncHB0JzsKICAgICAgfSAvLyDljLnphY0g6KeG6aKRCgoKICAgICAgdmFyIHZpZGVvbGlzdCA9IFsnbXA0JywgJ20ydicsICdta3YnLCAncm12YicsICd3bXYnLCAnYXZpJywgJ2ZsdicsICdtb3YnLCAnbTR2J107CiAgICAgIHJlc3VsdCA9IHZpZGVvbGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHN1ZmZpeDsKICAgICAgfSk7CgogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuICd2aWRlbyc7CiAgICAgIH0gLy8g5Yy56YWNIOmfs+mikQoKCiAgICAgIHZhciByYWRpb2xpc3QgPSBbJ21wMycsICd3YXYnLCAnd212J107CiAgICAgIHJlc3VsdCA9IHJhZGlvbGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHN1ZmZpeDsKICAgICAgfSk7CgogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuICdyYWRpbyc7CiAgICAgIH0gLy8g5YW25LuWIOaWh+S7tuexu+WeiwoKCiAgICAgIHJldHVybiAnb3RoZXInOwogICAgfSwKICAgIHByZXZpZXdQYXJ0TWF0ZXJpYWw6IGZ1bmN0aW9uIHByZXZpZXdQYXJ0TWF0ZXJpYWwoKSB7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZG9jdW1lbnRNYXRlcmlhbFRhYmxlRGF0YSk7CiAgICAgIHRoaXMuc2VsZWN0UHJldmlldygxKTsKICAgIH0sCiAgICBwcmV2aWV3QWxsTWF0ZXJpYWw6IGZ1bmN0aW9uIHByZXZpZXdBbGxNYXRlcmlhbCgpIHsKICAgICAgdGhpcy5zZWxlY3RQcmV2aWV3KDApOwogICAgfSwKICAgIHNlbGVjdFByZXZpZXc6IGZ1bmN0aW9uIHNlbGVjdFByZXZpZXcodmFsKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmRvY3VtZW50TWF0ZXJpYWxUYWJsZURhdGEubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBhcnJheSA9IHRoaXMuZG9jdW1lbnRNYXRlcmlhbFRhYmxlRGF0YTsKICAgICAgICB2YXIgbGlzdCA9IFtdOwogICAgICAgIHZhciBwcmV2aWV3SW1hZ2UgPSBbXTsKCiAgICAgICAgaWYgKHZhbCA9PT0gMSkgewogICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBpZiAoYXJyYXlbaW5kZXhdLnNpZ25TdGF0dXMgPT09IDEpIHsKICAgICAgICAgICAgICBsaXN0LnB1c2goYXJyYXlbaW5kZXhdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsaXN0ID0gdGhpcy5kb2N1bWVudE1hdGVyaWFsVGFibGVEYXRhOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgZm9yICh2YXIgX2luZGV4ID0gMDsgX2luZGV4IDwgbGlzdC5sZW5ndGg7IF9pbmRleCsrKSB7CiAgICAgICAgICAgIGRlLmdldEZpbGVJbWcoewogICAgICAgICAgICAgIGlkOiBsaXN0W19pbmRleF0uaWQKICAgICAgICAgICAgfSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgX3JlZjQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhyZXMpIHsKICAgICAgICAgICAgICAgIHZhciBpbWFnbExpc3QsIGksIGltZ1VybDsKICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuZGF0YS5zdWNjZXNzID09PSB0cnVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdsTGlzdCA9IHJlcy5kYXRhLmRhdGEuaWRzOwogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDcudDAgPSBfcmVnZW5lcmF0b3JSdW50aW1lLmtleXMoaW1hZ2xMaXN0KTsKCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoX2NvbnRleHQ3LnQxID0gX2NvbnRleHQ3LnQwKCkpLmRvbmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpID0gX2NvbnRleHQ3LnQxLnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEwLmdldEltZyhpbWFnbExpc3RbaV0sIDEpOwoKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgaW1nVXJsID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdJbWFnZS5wdXNoKGltZ1VybCk7CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kc3RvcmUuY29tbWl0KCdhcHAvQ0hBTkdFX0lNQUdFJywgcHJldmlld0ltYWdlKTsKCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSgpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5rKh5pyJ5Y+v6aKE6KeI55qE5paH5LmmJyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ayoeacieWPr+mihOiniOeahOaWh+S5picpOwogICAgICB9CiAgICB9LAogICAgc2V0U2lnbmF0dXJlOiBmdW5jdGlvbiBzZXRTaWduYXR1cmUoZSkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzZXRTaWduYXR1cmUiLCBlKTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczExLnN0YURhdGEub3JkZXJTdGF0dXMgPT0gMzA2KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczExLmhhbmRsZUNvbWZpcm0oIuW9k+WJjeiuouWNleW3suWujOaIkO+8jOmHjeiuvuW3suetvue9suaWh+S7tueahOetvuWQje+8jOWwhua4heepuuaJgOacieW3suetvue9suaWh+S7tueahOetvuWQje+8jOmcgOimgemHjeaWsOetvue9su+8jOehruWumue7p+e7reaTjeS9nOWQl++8nyIpLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHt9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ5LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgZGUuZ2V0RW50cnVzdEluZm8oewogICAgICAgICAgICAgICAgICBvcmRlcklkOiBfdGhpczExLm9yZGVySWQKICAgICAgICAgICAgICAgIH0pLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmNSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KHJlcykgewogICAgICAgICAgICAgICAgICAgIHZhciBmbGllTGlzdCwgZmlsZVNpZ25MaXN0LCBfaXRlcmF0b3IsIF9zdGVwLCBpLCBfaXRlcmF0b3IyLCBfc3RlcDIsIF9zdGVwMiR2YWx1ZSwgaW5kZXgsIGo7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NldFNpZ25hdHVyZScsIHJlcyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWVMaXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVTaWduTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZXMuZGF0YS5hbm5leERUT0xpc3QpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpZUxpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGkub3JpZ2luRmlsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogaS5maWxlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJlcy5kYXRhLmVudHJ1c3RMaXN0LmVudHJpZXMoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3RlcDIkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcDIudmFsdWUsIDIpLCBpbmRleCA9IF9zdGVwMiR2YWx1ZVswXSwgaiA9IF9zdGVwMiR2YWx1ZVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVTaWduTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbE5hbWU6IGoucmVhbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2VySWQ6IGouaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvd0xlZnRYOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dMZWZ0WTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJJZDogX3RoaXMxMS5vcmRlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlckRvY3VtZW50SWQ6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY292ZXJUeXBlOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgLy8gai5lZGl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBqLmdlbmRlciA9IGouZ2VuZGVyICsgIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3IgKGxldCBpIG9mIGoubWF0ZXJpYWxMaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGkudXJsID0gYXdhaXQgdGhpcy5nZXRJbWcoaS5pZCwgMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS5mbGllTGlzdCA9IGZsaWVMaXN0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczExLmZpbGVTaWduTGlzdCA9IGZpbGVTaWduTGlzdDsgLy8gdGhpcy5lbnRydXN0SW5mbyA9IHJlcy5kYXRhOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS5kb2NJbmZvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY0lkOiBlLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY05hbWU6IGUub3JpZ2luYWxGaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduU3RhdHVzOiBlLnNpZ25TdGF0dXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY292ZXJTdGF0dXM6IGUuY292ZXJTdGF0dXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGFsbFNldERpc3RyaWN0OiBmdW5jdGlvbiBhbGxTZXREaXN0cmljdCgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgICB2YXIgcmVzLCBpbmRleCwgZGF0YTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczEyLnN0YURhdGEub3JkZXJTdGF0dXMgPT0gMzA2KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTIuaGFuZGxlQ29tZmlybSgi5b2T5YmN6K6i5Y2V5bey5a6M5oiQ77yM6YeN6K6+5bey562+572y5paH5Lu255qE562+5ZCN77yM5bCG5riF56m65omA5pyJ5bey562+572y5paH5Lu255qE562+5ZCN77yM6ZyA6KaB6YeN5paw562+572y77yM56Gu5a6a57un57ut5pON5L2c5ZCX77yfIikuY2F0Y2goZnVuY3Rpb24gKGVycikge30pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDExLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMi5kb2N1bWVudE1hdGVyaWFsVGFibGVEYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMi5kb2NJbmZvID0gW107CiAgICAgICAgICAgICAgICAgIGRlLmdldEVudHJ1c3RJbmZvKHsKICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBfdGhpczEyLm9yZGVySWQKICAgICAgICAgICAgICAgICAgfSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZmxpZUxpc3QsIGZpbGVTaWduTGlzdCwgX2l0ZXJhdG9yMywgX3N0ZXAzLCBpLCBfaXRlcmF0b3I0LCBfc3RlcDQsIF9zdGVwNCR2YWx1ZSwgaW5kZXgsIGo7CgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpZUxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlU2lnbkxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVzLmRhdGEuYW5uZXhEVE9MaXN0KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWVMaXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGkub3JpZ2luRmlsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBpLmZpbGVOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IzLmUoZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVzLmRhdGEuZW50cnVzdExpc3QuZW50cmllcygpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNC5zKCk7ICEoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGVwNCR2YWx1ZSA9IF9zbGljZWRUb0FycmF5KF9zdGVwNC52YWx1ZSwgMiksIGluZGV4ID0gX3N0ZXA0JHZhbHVlWzBdLCBqID0gX3N0ZXA0JHZhbHVlWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlU2lnbkxpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbE5hbWU6IGoucmVhbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcG9zZXJJZDogai5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dMZWZ0WDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dMZWZ0WTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBfdGhpczEyLm9yZGVySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJEb2N1bWVudElkOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3ZlclR5cGU6IDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yNC5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczEyLmZsaWVMaXN0ID0gZmxpZUxpc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5maWxlU2lnbkxpc3QgPSBmaWxlU2lnbkxpc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDYpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0oKSk7CgogICAgICAgICAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBfdGhpczEyLmRvY3VtZW50TWF0ZXJpYWxUYWJsZURhdGEubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgIGRvY0lkOiBfdGhpczEyLmRvY3VtZW50TWF0ZXJpYWxUYWJsZURhdGFbaW5kZXhdLmlkLAogICAgICAgICAgICAgICAgICAgICAgZG9jTmFtZTogX3RoaXMxMi5kb2N1bWVudE1hdGVyaWFsVGFibGVEYXRhW2luZGV4XS5vcmlnaW5hbEZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgICAgc2lnblN0YXR1czogX3RoaXMxMi5kb2N1bWVudE1hdGVyaWFsVGFibGVEYXRhW2luZGV4XS5zaWduU3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgY292ZXJTdGF0dXM6IF90aGlzMTIuZG9jdW1lbnRNYXRlcmlhbFRhYmxlRGF0YVtpbmRleF0uY292ZXJTdGF0dXMKICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLmRvY0luZm8ucHVzaChkYXRhKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coX3RoaXMxMi5kb2NJbmZvKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTIuJG1lc3NhZ2UuZXJyb3IoJ+ivt+WFiOS4iuS8oOaWh+S5picpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIOaWh+S7tuWkmumAieS4iuS8oAogICAgdXBMb2FkRmlsZTogZnVuY3Rpb24gdXBMb2FkRmlsZShlKSB7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZ2V0RmlsZVR5cGUoZS5maWxlLm5hbWUpKTsKICAgICAgdmFyIHR5cGVMaXN0ID0gWycuZG9jJywgJy5wZGYnLCAnLmRvY3gnLCAnLkRPQycsICdET0NYJ107CiAgICAgIHZhciBmaWxlID0gZS5maWxlOwogICAgICB2YXIgZmlsZVR5cGUgPSBmaWxlLm5hbWUuc3Vic3RyaW5nKGZpbGUubmFtZS5sYXN0SW5kZXhPZignLicpKTsKICAgICAgdmFyIGlzRmlsZSA9IHR5cGVMaXN0LmluZGV4T2YoZmlsZVR5cGUpICE9PSAtMTsKICAgICAgdmFyIGlzTHQxNU0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDE1OwogICAgICB2YXIgZGF0YVR5cGUgPSBlLmRhdGEudHlwZTsKCiAgICAgIGlmICh0aGlzLmdldEZpbGVUeXBlKGUuZmlsZS5uYW1lKSAhPT0gJ3dvcmQnICYmIHRoaXMuZ2V0RmlsZVR5cGUoZS5maWxlLm5hbWUpICE9PSAncGRmJykgewogICAgICAgIHRoaXMuJGZ1bi5tc2coJ+ivt+S4iuS8oHBkZuOAgWRvY+OAgWRvY3jmoLzlvI/nmoTmlofku7YhJywgJ2Vycm9yJyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIWlzTHQxNU0pIHsKICAgICAgICB0aGlzLiRmdW4ubXNnKCfkuIrkvKDmlofku7bnmoTlpKflsI/lupTlsI/kuo4xNU0nLCAnZXJyb3InKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZpbGVTaG93Lmxlbmd0aCA+IDI5KSB7CiAgICAgICAgdGhpcy4kZnVuLm1zZygn5LiK5Lyg5paH5Lu255qE5pyA5aSaMzDku70nLCAnZXJyb3InKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChmaWxlLnNpemUgPT09IDApIHsKICAgICAgICB0aGlzLiRmdW4ubXNnKCfkuI3og73kuIrkvKDnqbrnmb3mlofku7YnLCAnZXJyb3InKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHRoaXMudXBGaWxlTGlzdC5wdXNoKGUuZmlsZSk7CiAgICAgIHRoaXMudHlwZSA9IGRhdGFUeXBlOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnVwRmlsZUxpc3QsICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0wMDAwMDAwMDAwMDAwLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7CgogICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy51cEZpbGVMaXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGlmICh0aGlzLmZpbGVTaG93LmluZGV4T2YodGhpcy51cEZpbGVMaXN0W2luZGV4XS5uYW1lKSA8IDApIHsKICAgICAgICAgIHRoaXMuZmlsZVNob3cucHVzaCh0aGlzLnVwRmlsZUxpc3RbaW5kZXhdLm5hbWUpOwogICAgICAgIH0KICAgICAgfSAvLyBpZiAoIXRoaXMuaXNVcCkgewogICAgICAvLyAgIHRoaXMuaXNVcCA9IHRydWUKICAgICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgLy8gICAgIHRoaXMudXBMb2FkQWxsKGRhdGFUeXBlKQogICAgICAvLyAgIH0sIDEwMDApCiAgICAgIC8vIH0KCiAgICB9LAogICAgdXBMb2FkQWxsOiBmdW5jdGlvbiB1cExvYWRBbGwodHlwZSkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICB0aGlzLiRmdW4ubXNnKCflvIDlp4vkuIrkvKAnLCAnc3VjY2VzcycpOwogICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy51cEZpbGVMaXN0KSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgdGhpcy51cEZpbGVMaXN0W2ldKTsKICAgICAgfQoKICAgICAgZm9ybURhdGEuYXBwZW5kKCdvcmRlcklkJywgdGhpcy5vcmRlcklkKTsKICAgICAgdGhpcy4kYXhpb3MoJ29yZy9vcmRlci1kb2N1bWVudCcsIGZvcm1EYXRhLCB7CiAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzLCAn5LiK5Lyg5oiQ5Yqf5ZCO55qE5pWw5o2uJyk7CgogICAgICAgIGlmIChyZXMuc3VjY2VzcyA9PT0gdHJ1ZSkgewogICAgICAgICAgdmFyIGxpc3QgPSBbXTsKCiAgICAgICAgICBpZiAodHlwZSA9PT0gJ3B1c2gnKSB7CiAgICAgICAgICAgIGxpc3QgPSBfdGhpczEzLmRvY0luZm9MaXN0OwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfaXRlcmF0b3I1ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVzLmRhdGEpLAogICAgICAgICAgICAgIF9zdGVwNTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBfaTIgPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICAgICAgbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIGRvY0lkOiBfaTIuaWQsCiAgICAgICAgICAgICAgICBkb2NOYW1lOiBfaTIub3JpZ2luYWxGaWxlbmFtZSwKICAgICAgICAgICAgICAgIHNpZ25TdGF0dXM6IF9pMi5zaWduU3RhdHVzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3I1LmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMTMuZG9jSW5mb0xpc3QgPSBsaXN0OwoKICAgICAgICAgIGlmICh0eXBlICE9PSAncHVzaCcpIHsKICAgICAgICAgICAgX3RoaXMxMy5nZXREb2NJbWcocmVzLmRhdGFbMF0uaWQpOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsaXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBfdGhpczEzLmZpbGVTaG93TGlzdERhdGEucHVzaChsaXN0W2luZGV4XSk7CiAgICAgICAgICB9IC8vIHRoaXMuZmlsZVNob3dMaXN0RGF0YSA9IGxpc3QKCgogICAgICAgICAgY29uc29sZS5sb2cobGlzdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMTMuJGZ1bi5tc2coJ+S4iuS8oOWksei0pe+8gScsICdlcnJvcicpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMudXBGaWxlTGlzdCA9IFtdOwogICAgICB0aGlzLmlzVXAgPSBmYWxzZTsKICAgIH0sCiAgICBnZXREb2NJbWc6IGZ1bmN0aW9uIGdldERvY0ltZyhpZCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICBkZS5nZXRGaWxlSW1nKHsKICAgICAgICBpZDogaWQKICAgICAgfSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZjcgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIocmVzKSB7CiAgICAgICAgICB2YXIgbGlzdCwgaW1nLCBpOwogICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAoIShyZXMuZGF0YS5zdWNjZXNzID09PSB0cnVlKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBsaXN0ID0gcmVzLmRhdGEuZGF0YS5pZHM7CiAgICAgICAgICAgICAgICAgIGltZyA9IFtdOwogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLnQwID0gX3JlZ2VuZXJhdG9yUnVudGltZS5rZXlzKGxpc3QpOwoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgaWYgKChfY29udGV4dDEyLnQxID0gX2NvbnRleHQxMi50MCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGkgPSBfY29udGV4dDEyLnQxLnZhbHVlOwogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLnQyID0gaW1nOwogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNC5nZXRJbWcobGlzdFtpXSk7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLnQzID0gX2NvbnRleHQxMi5zZW50OwoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi50Mi5wdXNoLmNhbGwoX2NvbnRleHQxMi50MiwgX2NvbnRleHQxMi50Myk7CgogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICBfdGhpczE0LmltZ0xpc3QgPSBpbWc7CiAgICAgICAgICAgICAgICAgIF90aGlzMTQuaXNTaXplID0gcmVzLmRhdGEuZGF0YS5wYXBlclR5cGUgPT09ICdBMycgPyAyIDogMTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTQuZ2V0U2lnbkxpc3QoaWQpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMTIpOwogICAgICAgIH0pKTsKCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDcpIHsKICAgICAgICAgIHJldHVybiBfcmVmNy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKSk7CiAgICB9LAogICAgZ2V0U2lnbkxpc3Q6IGZ1bmN0aW9uIGdldFNpZ25MaXN0KGlkKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIGRlLmdldFNpZ25EaXYoewogICAgICAgIG9yZGVyRG9jdW1lbnRJZDogaWQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzID09PSB0cnVlKSB7CiAgICAgICAgICBpZiAocmVzLmRhdGEgIT0gbnVsbCB8fCByZXMuZGF0YS5sZW5ndGggIT09IDApIHsKICAgICAgICAgICAgdmFyIGxpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcy5kYXRhKSk7CiAgICAgICAgICAgIF90aGlzMTUuc2lnbkxpc3QgPSBsaXN0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2FuY2VsVXBsb2FkaW5nOiBmdW5jdGlvbiBjYW5jZWxVcGxvYWRpbmcoKSB7CiAgICAgIHRoaXMudXBsb2FkTWF0ZXJpYWxEaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgYWZmaXJtVXBsb2FkaW5nOiBmdW5jdGlvbiBhZmZpcm1VcGxvYWRpbmcoKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmZpbGVTaG93Lmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLiRmdW4ubXNnKCflvIDlp4vkuIrkvKAnLCAnc3VjY2VzcycpOwogICAgICAgIHZhciB0eXBlID0gdGhpcy50eXBlOwogICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwoKICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMudXBGaWxlTGlzdCkgewogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgdGhpcy51cEZpbGVMaXN0W2ldKTsKICAgICAgICB9CgogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnb3JkZXJJZCcsIHRoaXMub3JkZXJJZCk7CiAgICAgICAgdGhpcy4kYXhpb3MoJ29yZy9hY2NlcHRhbmNlLW9yZGVyLWRvY3VtZW50JywgZm9ybURhdGEsIHsKICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMsICfkuIrkvKDmiJDlip/lkI7nmoTmlbDmja4nKTsKCiAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MgPT09IHRydWUpIHsKICAgICAgICAgICAgX3RoaXMxNi51cGxvYWRNYXRlcmlhbERpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTsKCiAgICAgICAgICAgIGlmICh0eXBlID09PSAncHVzaCcpIHsKICAgICAgICAgICAgICBsaXN0ID0gX3RoaXMxNi5kb2NJbmZvTGlzdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIF9pdGVyYXRvcjYgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZXMuZGF0YSksCiAgICAgICAgICAgICAgICBfc3RlcDY7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNi5zKCk7ICEoX3N0ZXA2ID0gX2l0ZXJhdG9yNi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICB2YXIgX2k0ID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgICAgICAgbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgZG9jSWQ6IF9pNC5pZCwKICAgICAgICAgICAgICAgICAgZG9jTmFtZTogX2k0Lm9yaWdpbmFsRmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgIHNpZ25TdGF0dXM6IF9pNC5zaWduU3RhdHVzCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9pdGVyYXRvcjYuZShlcnIpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIF9pdGVyYXRvcjYuZigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczE2LmRvY0luZm9MaXN0ID0gbGlzdDsKCiAgICAgICAgICAgIGlmICh0eXBlICE9PSAncHVzaCcpIHsKICAgICAgICAgICAgICBfdGhpczE2LmdldERvY0ltZyhyZXMuZGF0YVswXS5pZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsaXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgIF90aGlzMTYuZmlsZVNob3dMaXN0RGF0YS5wdXNoKGxpc3RbaW5kZXhdKTsKICAgICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyhsaXN0KQoKCiAgICAgICAgICAgIF90aGlzMTYuZG9jSW5mbyA9IFtdOwogICAgICAgICAgICBkZS5nZXRFbnRydXN0SW5mbyh7CiAgICAgICAgICAgICAgb3JkZXJJZDogX3RoaXMxNi5vcmRlcklkCiAgICAgICAgICAgIH0pLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIF9yZWY4ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKHJlcykgewogICAgICAgICAgICAgICAgdmFyIGZsaWVMaXN0LCBmaWxlU2lnbkxpc3QsIF9pdGVyYXRvcjcsIF9zdGVwNywgX2kzLCBfaXRlcmF0b3I4LCBfc3RlcDgsIF9zdGVwOCR2YWx1ZSwgX2luZGV4MiwgajsKCiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBmbGllTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVTaWduTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjcgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZXMuZGF0YS5hbm5leERUT0xpc3QpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3I3LnMoKTsgIShfc3RlcDcgPSBfaXRlcmF0b3I3Lm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2kzID0gX3N0ZXA3LnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGllTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBfaTMub3JpZ2luRmlsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBfaTMuZmlsZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFycwoKICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjcuZShlcnIpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3I3LmYoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjggPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZXMuZGF0YS5lbnRydXN0TGlzdC5lbnRyaWVzKCkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3I4LnMoKTsgIShfc3RlcDggPSBfaXRlcmF0b3I4Lm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N0ZXA4JHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXA4LnZhbHVlLCAyKSwgX2luZGV4MiA9IF9zdGVwOCR2YWx1ZVswXSwgaiA9IF9zdGVwOCR2YWx1ZVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVNpZ25MaXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxOYW1lOiBqLnJlYWxOYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2VySWQ6IGouaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG93TGVmdFg6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG93TGVmdFk6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJJZDogX3RoaXMxNi5vcmRlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyRG9jdW1lbnRJZDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY292ZXJUeXBlOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yOC5lKGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjguZigpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxNi5mbGllTGlzdCA9IGZsaWVMaXN0OwogICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTYuZmlsZVNpZ25MaXN0ID0gZmlsZVNpZ25MaXN0OwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgX2NhbGxlZTEzKTsKICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g4KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KCkpOwogICAgICAgICAgICBfdGhpczE2LmRvY0luZm8gPSBfdGhpczE2LmZpbGVTaG93TGlzdERhdGE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczE2LiRmdW4ubXNnKCfkuIrkvKDlpLHotKXvvIEnLCAnZXJyb3InKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB0aGlzLnVwRmlsZUxpc3QgPSBbXTsKICAgICAgICB0aGlzLmlzVXAgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fkuIrkvKDmlofku7YnKTsKICAgICAgfQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICJmaWxlU2hvdy5sZW5ndGgiOiBmdW5jdGlvbiBmaWxlU2hvd0xlbmd0aCgpIHsKICAgICAgdGhpcy5maWxlU2hvdy5sZW5ndGggJiYgdGhpcy5hZmZpcm1VcGxvYWRpbmcoKTsKICAgICAgdGhpcy4kZW1pdCgidXBkYXRlRGF0YSIpOwogICAgfQogIH0KfTs="},null]}