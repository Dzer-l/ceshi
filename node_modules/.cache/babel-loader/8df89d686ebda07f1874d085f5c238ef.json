{"remainingRequest":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/thread-loader/dist/cjs.js!/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/home/jenkins_data/workspace/页面-公证处后台/src/utils/web-office-sdk-v1.1.12.es.js","dependencies":[{"path":"/home/jenkins_data/workspace/页面-公证处后台/src/utils/web-office-sdk-v1.1.12.es.js","mtime":1634724784703},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jenkins_data/workspace/页面-公证处后台/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9Cgp2YXIgX2UgPSBmdW5jdGlvbiBlKCkgewogIHJldHVybiAoX2UgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIChlKSB7CiAgICBmb3IgKHZhciB0LCBuID0gMSwgciA9IGFyZ3VtZW50cy5sZW5ndGg7IG4gPCByOyBuKyspIHsKICAgICAgZm9yICh2YXIgYSBpbiB0ID0gYXJndW1lbnRzW25dKSB7CiAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIGEpICYmIChlW2FdID0gdFthXSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZTsKICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwoKZnVuY3Rpb24gdChlLCB0LCBuLCByKSB7CiAgcmV0dXJuIG5ldyAobiB8fCAobiA9IFByb21pc2UpKShmdW5jdGlvbiAoYSwgaSkgewogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgYyhyLm5leHQoZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgaShlKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHMoZSkgewogICAgICB0cnkgewogICAgICAgIGMoci50aHJvdyhlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBpKGUpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYyhlKSB7CiAgICAgIHZhciB0OwogICAgICBlLmRvbmUgPyBhKGUudmFsdWUpIDogKHQgPSBlLnZhbHVlLCB0IGluc3RhbmNlb2YgbiA/IHQgOiBuZXcgbihmdW5jdGlvbiAoZSkgewogICAgICAgIGUodCk7CiAgICAgIH0pKS50aGVuKG8sIHMpOwogICAgfQoKICAgIGMoKHIgPSByLmFwcGx5KGUsIHQgfHwgW10pKS5uZXh0KCkpOwogIH0pOwp9CgpmdW5jdGlvbiBuKGUsIHQpIHsKICB2YXIgbiwKICAgICAgciwKICAgICAgYSwKICAgICAgaSwKICAgICAgbyA9IHsKICAgIGxhYmVsOiAwLAogICAgc2VudDogZnVuY3Rpb24gc2VudCgpIHsKICAgICAgaWYgKDEgJiBhWzBdKSB0aHJvdyBhWzFdOwogICAgICByZXR1cm4gYVsxXTsKICAgIH0sCiAgICB0cnlzOiBbXSwKICAgIG9wczogW10KICB9OwogIHJldHVybiBpID0gewogICAgbmV4dDogcygwKSwKICAgIHRocm93OiBzKDEpLAogICAgcmV0dXJuOiBzKDIpCiAgfSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIChpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpczsKICB9KSwgaTsKCiAgZnVuY3Rpb24gcyhpKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKHMpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpKSB7CiAgICAgICAgaWYgKG4pIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsKCiAgICAgICAgZm9yICg7IG87KSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAobiA9IDEsIHIgJiYgKGEgPSAyICYgaVswXSA/IHIucmV0dXJuIDogaVswXSA/IHIudGhyb3cgfHwgKChhID0gci5yZXR1cm4pICYmIGEuY2FsbChyKSwgMCkgOiByLm5leHQpICYmICEoYSA9IGEuY2FsbChyLCBpWzFdKSkuZG9uZSkgcmV0dXJuIGE7CgogICAgICAgICAgICBzd2l0Y2ggKHIgPSAwLCBhICYmIChpID0gWzIgJiBpWzBdLCBhLnZhbHVlXSksIGlbMF0pIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgYSA9IGk7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmV0dXJuIG8ubGFiZWwrKywgewogICAgICAgICAgICAgICAgICB2YWx1ZTogaVsxXSwKICAgICAgICAgICAgICAgICAgZG9uZTogITEKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIG8ubGFiZWwrKywgciA9IGlbMV0sIGkgPSBbMF07CiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaSA9IG8ub3BzLnBvcCgpLCBvLnRyeXMucG9wKCk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIGlmICghKGEgPSAoYSA9IG8udHJ5cykubGVuZ3RoID4gMCAmJiBhW2EubGVuZ3RoIC0gMV0pICYmICg2ID09PSBpWzBdIHx8IDIgPT09IGlbMF0pKSB7CiAgICAgICAgICAgICAgICAgIG8gPSAwOwogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoMyA9PT0gaVswXSAmJiAoIWEgfHwgaVsxXSA+IGFbMF0gJiYgaVsxXSA8IGFbM10pKSB7CiAgICAgICAgICAgICAgICAgIG8ubGFiZWwgPSBpWzFdOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoNiA9PT0gaVswXSAmJiBvLmxhYmVsIDwgYVsxXSkgewogICAgICAgICAgICAgICAgICBvLmxhYmVsID0gYVsxXSwgYSA9IGk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChhICYmIG8ubGFiZWwgPCBhWzJdKSB7CiAgICAgICAgICAgICAgICAgIG8ubGFiZWwgPSBhWzJdLCBvLm9wcy5wdXNoKGkpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhWzJdICYmIG8ub3BzLnBvcCgpLCBvLnRyeXMucG9wKCk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaSA9IHQuY2FsbChlLCBvKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgaSA9IFs2LCBlXSwgciA9IDA7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBuID0gYSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoNSAmIGlbMF0pIHRocm93IGlbMV07CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHZhbHVlOiBpWzBdID8gaVsxXSA6IHZvaWQgMCwKICAgICAgICAgIGRvbmU6ICEwCiAgICAgICAgfTsKICAgICAgfShbaSwgc10pOwogICAgfTsKICB9Cn0KCnZhciByID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGUoKSB7fQoKICByZXR1cm4gZS5hZGQgPSBmdW5jdGlvbiAodCkgewogICAgZS5IQU5ETEVfTElTVC5wdXNoKHQpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHQsICExKTsKICB9LCBlLnJlbW92ZSA9IGZ1bmN0aW9uICh0KSB7CiAgICB2YXIgbiA9IGUuSEFORExFX0xJU1QuaW5kZXhPZih0KTsKICAgIG4gPj0gMCAmJiBlLkhBTkRMRV9MSVNULnNwbGljZShuLCAxKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0LCAhMSk7CiAgfSwgZS5lbXB0eSA9IGZ1bmN0aW9uICgpIHsKICAgIGZvciAoOyBlLkhBTkRMRV9MSVNULmxlbmd0aDspIHsKICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBlLkhBTkRMRV9MSVNULnNoaWZ0KCksICExKTsKICAgIH0KICB9LCBlLnBhcnNlID0gZnVuY3Rpb24gKGUpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiAib2JqZWN0IiA9PSBfdHlwZW9mKGUpID8gZSA6IGUgPyBKU09OLnBhcnNlKGUpIDogZTsKICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCJNZXNzYWdlLnBhcnNlIEVycm9yOiIsIHQpLCBlOwogICAgfQogIH0sIGUuSEFORExFX0xJU1QgPSBbXSwgZTsKfSgpOwoKZnVuY3Rpb24gYShlKSB7CiAgcmV0dXJuICJbb2JqZWN0IEZ1bmN0aW9uXSIgPT09IHt9LnRvU3RyaW5nLmNhbGwoZSk7Cn0KCnZhciBpLAogICAgbywKICAgIHMsCiAgICBjLAogICAgdSA9IHsKICBvcmlnaW46ICIiCn07CgpmdW5jdGlvbiBsKGUpIHsKICByZXR1cm4gdVtlXTsKfQoKZnVuY3Rpb24gZChlKSB7CiAgcmV0dXJuIGwoIm9yaWdpbiIpICE9PSBlLm9yaWdpbiAmJiAoY29uc29sZS5lcnJvcigicG9zdE1lc3NhZ2Ug5Z+f5ZCN5qOA5p+l5LiN6YCa6L+HIiksICEwKTsKfQoKIWZ1bmN0aW9uIChlKSB7CiAgZS51bmtub3duID0gInVua25vd24iLCBlLnNwcmVhZHNoZWV0ID0gInMiLCBlLndyaXRlciA9ICJ3IiwgZS5wcmVzZW50YXRpb24gPSAicCIsIGUucGRmID0gImYiOwp9KGkgfHwgKGkgPSB7fSkpLCBmdW5jdGlvbiAoZSkgewogIGUud3BzID0gInciLCBlLmV0ID0gInMiLCBlLnByZXNlbnRhdGlvbiA9ICJwIiwgZS5wZGYgPSAiZiI7Cn0obyB8fCAobyA9IHt9KSksIGZ1bmN0aW9uIChlKSB7CiAgZS5ub21hbCA9ICJub21hbCIsIGUuc2ltcGxlID0gInNpbXBsZSI7Cn0ocyB8fCAocyA9IHt9KSksIGZ1bmN0aW9uIChlKSB7CiAgZVtlLnJlcXVlc3RGdWxsc2NyZWVuID0gMV0gPSAicmVxdWVzdEZ1bGxzY3JlZW4iLCBlW2UuZXhpdEZ1bGxzY3JlZW4gPSAwXSA9ICJleGl0RnVsbHNjcmVlbiI7Cn0oYyB8fCAoYyA9IHt9KSk7Cgp2YXIgcCwKICAgIGYsCiAgICB2ID0gKHAgPSAwLCBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHAgKz0gMTsKfSksCiAgICBiID0gZnVuY3Rpb24gYihlLCB0LCBuKSB7CiAgdm9pZCAwID09PSBuICYmIChuID0gITApOwogIHZhciByID0gdDsKCiAgaWYgKCFmKSB7CiAgICB2YXIgYSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGYuc3R5bGUuY3NzVGV4dCArPSAiaGVpZ2h0OiAiICsgZS5jbGllbnRIZWlnaHQgKyAicHg7IHdpZHRoOiAiICsgZS5jbGllbnRXaWR0aCArICJweCI7CiAgICB9LmJpbmQobnVsbCwgcik7CgogICAgKGYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSkuY2xhc3NMaXN0LmFkZCgid2ViLW9mZmljZS1pZnJhbWUiKTsKICAgIHZhciBpID0gewogICAgICBpZDogIm9mZmljZS1pZnJhbWUiLAogICAgICBzcmM6IGUsCiAgICAgIHNjcm9sbGluZzogIm5vIiwKICAgICAgZnJhbWVib3JkZXI6ICIwIiwKICAgICAgYWxsb3dmdWxsc2NyZWVuOiAiYWxsb3dmdWxsc2NyZWVuIiwKICAgICAgd2Via2l0YWxsb3dmdWxsc2NyZWVuOiAidHJ1ZSIsCiAgICAgIG1vemFsbG93ZnVsbHNjcmVlbjogInRydWUiCiAgICB9OwoKICAgIGZvciAodmFyIG8gaW4gciA/IChpLnN0eWxlID0gIndpZHRoOiAiICsgci5jbGllbnRXaWR0aCArICJweDsgaGVpZ2h0OiAiICsgci5jbGllbnRIZWlnaHQgKyAicHg7IiwgbiAmJiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgYSkpIDogKChyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmNsYXNzTGlzdC5hZGQoIndlYi1vZmZpY2UtZGVmYXVsdC1jb250YWluZXIiKSwgZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHQpOwogICAgICB2YXIgbiA9IHQuc2hlZXQ7CiAgICAgIG4uaW5zZXJ0UnVsZShlLCBuLmNzc1J1bGVzLmxlbmd0aCk7CiAgICB9KCIud2ViLW9mZmljZS1kZWZhdWx0LWNvbnRhaW5lciB7cG9zaXRpb246IGFic29sdXRlOyBwYWRkaW5nOiAwOyAgbWFyZ2luOiAwOyB3aWR0aDogMTAwdnc7IGhlaWdodDogMTAwdmg7IGxlZnQ6IDA7IHRvcDogMDt9IiksIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQociksIGkuc3R5bGUgPSAid2lkdGg6IDEwMHZ3OyBoZWlnaHQ6IDEwMHZoOyIpLCBpKSB7CiAgICAgIGYuc2V0QXR0cmlidXRlKG8sIGlbb10pOwogICAgfQoKICAgIHIuYXBwZW5kQ2hpbGQoZiksIGYuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgICAgZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpLCBmID0gbnVsbCwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIGEpOwogICAgfTsKICB9CgogIHJldHVybiBmOwp9OwoKdmFyIGggPSBmdW5jdGlvbiBoKGUpIHsKICB2YXIgdCA9IFsiaXNQYXJlbnRGdWxsc2NyZWVuIl07CgogIGlmICgic2V0Q29uZmlnIiA9PT0gZS5ldmVudE5hbWUpIHsKICAgIHZhciBuID0gZS5kYXRhLmNvbW1vbk9wdGlvbnM7CgogICAgZm9yICh2YXIgciBpbiBuKSB7CiAgICAgIHQuaW5jbHVkZXMocikgJiYgKG5bcl0gPSB2b2lkIDApOwogICAgfQoKICAgIGUuZGF0YS5jb21tb25PcHRpb25zID0gbjsKICB9CgogIGIoKS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KGUpLCBsKCJvcmlnaW4iKSk7Cn07CgpmdW5jdGlvbiBtKGUsIHQsIG4pIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEpIHsKICAgIHZhciBpID0gdigpLAogICAgICAgIG8gPSBmdW5jdGlvbiBvKGUpIHsKICAgICAgaWYgKCFkKGUpKSB7CiAgICAgICAgdmFyIHQgPSByLnBhcnNlKGUuZGF0YSk7CiAgICAgICAgdC5ldmVudE5hbWUgPT09IG4gJiYgdC5tc2dJZCA9PT0gaSAmJiAoYSh0LmRhdGEpLCByLnJlbW92ZShvKSk7CiAgICAgIH0KICAgIH07CgogICAgci5hZGQobyksIGgoewogICAgICBkYXRhOiBlLAogICAgICBtc2dJZDogaSwKICAgICAgZXZlbnROYW1lOiB0CiAgICB9KTsKICB9KTsKfQoKdmFyIGcgPSBmdW5jdGlvbiBnKGUpIHsKICByZXR1cm4gbShlLCAid3BzLmpzc2RrLmFwaSIsICJ3cHMuYXBpLnJlcGx5Iik7Cn0sCiAgICB3ID0gZnVuY3Rpb24gdyhlKSB7CiAgcmV0dXJuIG0oZSwgImFwaS5iYXNpYyIsICJhcGkuYmFzaWMucmVwbHkiKTsKfSwKICAgIHkgPSB7CiAgaWRNYXA6IHt9Cn07CgpmdW5jdGlvbiBrKGUpIHsKICByZXR1cm4gdCh0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgdmFyIHQsIGEsIGksIG8sIHMsIGMsIHUsIGwsIHAsIGY7CiAgICByZXR1cm4gbih0aGlzLCBmdW5jdGlvbiAobikgewogICAgICBzd2l0Y2ggKG4ubGFiZWwpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXR1cm4gZChlKSA/IFsyXSA6ICh0ID0gci5wYXJzZShlLmRhdGEpLCBhID0gdC5ldmVudE5hbWUsIGkgPSB0LmNhbGxiYWNrSWQsIG8gPSB0LmRhdGEsIGkgJiYgKHMgPSB5LmlkTWFwW2ldKSA/IChjID0gcy5zcGxpdCgiOiIpLCB1ID0gY1swXSwgbCA9IGNbMV0sICJhcGkuY2FsbGJhY2siID09PSBhICYmIHlbdV0gJiYgeVt1XVtsXSA/IFs0LCAoZiA9IHlbdV1bbF0pLmNhbGxiYWNrLmFwcGx5KGYsIG8uYXJncyldIDogWzMsIDJdKSA6IFszLCAyXSk7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHAgPSBuLnNlbnQoKSwgaCh7CiAgICAgICAgICAgIHJlc3VsdDogcCwKICAgICAgICAgICAgY2FsbGJhY2tJZDogaSwKICAgICAgICAgICAgZXZlbnROYW1lOiAiYXBpLmNhbGxiYWNrLnJlcGx5IgogICAgICAgICAgfSksIG4ubGFiZWwgPSAyOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXR1cm4gWzJdOwogICAgICB9CiAgICB9KTsKICB9KTsKfQoKdmFyIGogPSBmdW5jdGlvbiBqKGUpIHsKICByZXR1cm4gdCh2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiB0KCkgewogICAgICByZXR1cm4gT2JqZWN0LmtleXMoeS5pZE1hcCkuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiB5LmlkTWFwW2VdID09PSBpICsgIjoiICsgYTsKICAgICAgfSk7CiAgICB9CgogICAgdmFyIGEsIGksIG8sIHMsIGMsIHUsIGwsIGQsIHA7CiAgICByZXR1cm4gbih0aGlzLCBmdW5jdGlvbiAobikgewogICAgICBzd2l0Y2ggKG4ubGFiZWwpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXR1cm4gYSA9IGUucHJvcCwgaSA9IGUucGFyZW50T2JqSWQsIFs0LCBPKFtvID0gZS52YWx1ZV0pXTsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuIHMgPSBuLnNlbnQoKSwgYyA9IHNbMF0sIHUgPSBzWzFdLCBlLnZhbHVlID0gY1swXSwgbCA9IE9iamVjdC5rZXlzKHUpWzBdLCBkID0geVtpXSwgbnVsbCA9PT0gbyAmJiBkICYmIGRbYV0gJiYgKChwID0gdCgpKSAmJiBkZWxldGUgeS5pZE1hcFtwXSwgZGVsZXRlIGRbYV0sIE9iamVjdC5rZXlzKGQpLmxlbmd0aCB8fCBkZWxldGUgeVtpXSwgT2JqZWN0LmtleXMoeS5pZE1hcCkubGVuZ3RoIHx8IHIucmVtb3ZlKGspKSwgbCAmJiAoT2JqZWN0LmtleXMoeS5pZE1hcCkubGVuZ3RoIHx8IHIuYWRkKGspLCB5W2ldIHx8ICh5W2ldID0ge30pLCB5W2ldW2FdID0gewogICAgICAgICAgICBjYWxsYmFja0lkOiBsLAogICAgICAgICAgICBjYWxsYmFjazogdVtsXQogICAgICAgICAgfSwgKHAgPSB0KCkpICYmIGRlbGV0ZSB5LmlkTWFwW3BdLCB5LmlkTWFwW2xdID0gaSArICI6IiArIGEpLCBbMl07CiAgICAgIH0KICAgIH0pOwogIH0pOwp9LAogICAgSSA9IGZ1bmN0aW9uIEkoYSwgaSwgbywgcykgewogIHJldHVybiB0KHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgIHZhciBjLCB1LCBsLCBwLCBmLCBiLCBtLCBnOwogICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKHcpIHsKICAgICAgc3dpdGNoICh3LmxhYmVsKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmV0dXJuIGMgPSB2KCksIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICB1ID0gZSwgbCA9IHQ7CiAgICAgICAgICB9KSwgZiA9IHt9LCBpLmFyZ3MgPyBbNCwgTyhpLmFyZ3MpXSA6IFszLCAyXTsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgYiA9IHcuc2VudCgpLCBtID0gYlswXSwgZyA9IGJbMV0sIGkuYXJncyA9IG0sIGYgPSBnLCB3LmxhYmVsID0gMjsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuICJhcGkuc2V0dGVyIiAhPT0gYSA/IFszLCA0XSA6IFs0LCBqKGkpXTsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdy5zZW50KCksIHcubGFiZWwgPSA0OwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSB0WzBdLAogICAgICAgICAgICAgICAgciA9IHRbMV07CiAgICAgICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIChuID0gX2Uoe30sIG4pKS5kYXRhICYmIChuLmRhdGEgPSBuLmRhdGEoKSk7CiAgICAgICAgICAgIHIoKSwgaChuKTsKICAgICAgICAgIH0oW3sKICAgICAgICAgICAgZXZlbnROYW1lOiBhLAogICAgICAgICAgICBkYXRhOiBpLAogICAgICAgICAgICBtc2dJZDogYwogICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICAgICAgICBpID0gZnVuY3Rpb24gaShwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQoZSwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBlLCB0LCB2OwogICAgICAgICAgICAgICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgICAgICAgc3dpdGNoIChuLmxhYmVsKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQocCkgPyBbMl0gOiAiYXBpLmNhbGxiYWNrIiA9PT0gKGUgPSByLnBhcnNlKHAuZGF0YSkpLmV2ZW50TmFtZSAmJiBlLmNhbGxiYWNrSWQgJiYgZltlLmNhbGxiYWNrSWRdID8gWzQsIGZbZS5jYWxsYmFja0lkXS5hcHBseShmLCBlLmRhdGEuYXJncyldIDogWzMsIDJdOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICB0ID0gbi5zZW50KCksIGgoewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IHQsCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogImFwaS5jYWxsYmFjay5yZXBseSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrSWQ6IGUuY2FsbGJhY2tJZAogICAgICAgICAgICAgICAgICAgICAgfSksIG4ubGFiZWwgPSAyOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS5ldmVudE5hbWUgPT09IGEgKyAiLnJlcGx5IiAmJiBlLm1zZ0lkID09PSBjICYmIChlLmVycm9yID8gKCh2ID0gbmV3IEVycm9yKCIiKSkuc3RhY2sgPSBlLmVycm9yICsgIlxuIiArIG8sIHMgJiYgcygpLCBsKHYpKSA6IHUoZS5yZXN1bHQpLCByLnJlbW92ZShpKSksIFsyXTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICByZXR1cm4gci5hZGQoaSksIHA7CiAgICAgICAgICB9XSksIFsyLCBwXTsKICAgICAgfQogICAgfSk7CiAgfSk7Cn07CgpmdW5jdGlvbiBPKGUpIHsKICByZXR1cm4gdCh0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgdmFyIHQsIHIsIGEsIGksIG8sIHMsIGMsIHUsIGwsIGQsIHA7CiAgICByZXR1cm4gbih0aGlzLCBmdW5jdGlvbiAobikgewogICAgICBzd2l0Y2ggKG4ubGFiZWwpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB0ID0ge30sIHIgPSBbXSwgYSA9IGUuc2xpY2UoMCksIG4ubGFiZWwgPSAxOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gYS5sZW5ndGggPyAoaSA9IHZvaWQgMCwgWzQsIGEuc2hpZnQoKV0pIDogWzMsIDEzXTsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuIChvID0gbi5zZW50KCkpICYmIG8uZG9uZSA/IFs0LCBvLmRvbmUoKV0gOiBbMywgNF07CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIG4uc2VudCgpLCBuLmxhYmVsID0gNDsKCiAgICAgICAgY2FzZSA0OgogICAgICAgICAgaWYgKCFmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoIWUpIHJldHVybiAhMTsKCiAgICAgICAgICAgIGZvciAodmFyIHQgPSBlOyBudWxsICE9PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodCk7KSB7CiAgICAgICAgICAgICAgdCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZihlKSA9PT0gdDsKICAgICAgICAgIH0oaSkpIHJldHVybiBbMywgMTFdOwoKICAgICAgICAgIGZvciAoYyBpbiBpID0ge30sIHMgPSBbXSwgbykgewogICAgICAgICAgICBzLnB1c2goYyk7CiAgICAgICAgICB9CgogICAgICAgICAgdSA9IDAsIG4ubGFiZWwgPSA1OwoKICAgICAgICBjYXNlIDU6CiAgICAgICAgICByZXR1cm4gdSA8IHMubGVuZ3RoID8gKGwgPSBzW3VdLCBkID0gb1tsXSwgL15bQS1aXS8udGVzdChsKSA/IGQgJiYgZC5kb25lID8gWzQsIGQuZG9uZSgpXSA6IFszLCA3XSA6IFszLCA4XSkgOiBbMywgMTBdOwoKICAgICAgICBjYXNlIDY6CiAgICAgICAgICBuLnNlbnQoKSwgbi5sYWJlbCA9IDc7CgogICAgICAgIGNhc2UgNzoKICAgICAgICAgIGQgJiYgZC5vYmpJZCA/IGQgPSB7CiAgICAgICAgICAgIG9iaklkOiBkLm9iaklkCiAgICAgICAgICB9IDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZCAmJiAocCA9IHYoKSwgdFtwXSA9IGQsIGQgPSB7CiAgICAgICAgICAgIGNhbGxiYWNrSWQ6IHAKICAgICAgICAgIH0pLCBuLmxhYmVsID0gODsKCiAgICAgICAgY2FzZSA4OgogICAgICAgICAgaVtsXSA9IGQsIG4ubGFiZWwgPSA5OwoKICAgICAgICBjYXNlIDk6CiAgICAgICAgICByZXR1cm4gdSsrLCBbMywgNV07CgogICAgICAgIGNhc2UgMTA6CiAgICAgICAgICByZXR1cm4gWzMsIDEyXTsKCiAgICAgICAgY2FzZSAxMToKICAgICAgICAgIG8gJiYgby5vYmpJZCA/IGkgPSB7CiAgICAgICAgICAgIG9iaklkOiBvLm9iaklkCiAgICAgICAgICB9IDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgbyAmJiB2b2lkIDAgPT09IG8ub2JqSWQgPyAocCA9IHYoKSwgdFtwXSA9IG8sIGkgPSB7CiAgICAgICAgICAgIGNhbGxiYWNrSWQ6IHAKICAgICAgICAgIH0pIDogaSA9IG8sIG4ubGFiZWwgPSAxMjsKCiAgICAgICAgY2FzZSAxMjoKICAgICAgICAgIHJldHVybiByLnB1c2goaSksIFszLCAxXTsKCiAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIHJldHVybiBbMiwgW3IsIHRdXTsKICAgICAgfQogICAgfSk7CiAgfSk7Cn0KCnZhciB4ID0gZnVuY3Rpb24geCh0LCBuKSB7CiAgdm9pZCAwID09PSBuICYmIChuID0gITApOwoKICB2YXIgciA9IF9lKHt9LCB0KSwKICAgICAgYSA9IHIuaGVhZGVycywKICAgICAgaSA9IHZvaWQgMCA9PT0gYSA/IHt9IDogYSwKICAgICAgbyA9IHIuc3Vic2NyaXB0aW9ucywKICAgICAgYyA9IHZvaWQgMCA9PT0gbyA/IHt9IDogbywKICAgICAgdSA9IHIubW9kZSwKICAgICAgbCA9IHZvaWQgMCA9PT0gdSA/IHMubm9tYWwgOiB1LAogICAgICBkID0gci5jb21tb25PcHRpb25zLAogICAgICBwID0gaS5iYWNrQnRuLAogICAgICBmID0gdm9pZCAwID09PSBwID8ge30gOiBwLAogICAgICB2ID0gaS5zaGFyZUJ0biwKICAgICAgYiA9IHZvaWQgMCA9PT0gdiA/IHt9IDogdiwKICAgICAgaCA9IGkub3RoZXJNZW51QnRuLAogICAgICBtID0gdm9pZCAwID09PSBoID8ge30gOiBoLAogICAgICBnID0gZnVuY3Rpb24gZyhlLCB0KSB7CiAgICBlLnN1YnNjcmliZSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBlLnN1YnNjcmliZSAmJiAoZS5jYWxsYmFjayA9IHQsIGNbdF0gPSBlLnN1YnNjcmliZSwgbiAmJiBkZWxldGUgZS5zdWJzY3JpYmUpOwogIH07CgogIGlmIChnKGYsICJ3cHNjb25maWdfYmFja19idG4iKSwgZyhiLCAid3BzY29uZmlnX3NoYXJlX2J0biIpLCBnKG0sICJ3cHNjb25maWdfb3RoZXJfbWVudV9idG4iKSwgbS5pdGVtcyAmJiBBcnJheS5pc0FycmF5KG0uaXRlbXMpKSB7CiAgICB2YXIgdyA9IFtdOwogICAgbS5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHN3aXRjaCAodm9pZCAwID09PSBlICYmIChlID0ge30pLCBlLnR5cGUpIHsKICAgICAgICBjYXNlICJleHBvcnRfaW1nIjoKICAgICAgICAgIGUudHlwZSA9IDEsIGUuY2FsbGJhY2sgPSAiZXhwb3J0X2ltZyI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZXhwb3J0X3BkZiI6CiAgICAgICAgICBlLnR5cGUgPSAxLCBlLmNhbGxiYWNrID0gImV4cG9ydF9wZGYiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInNhdmVfdmVyc2lvbiI6CiAgICAgICAgICBlLnR5cGUgPSAxLCBlLmNhbGxiYWNrID0gInNhdmVfdmVyc2lvbiI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYWJvdXRfd3BzIjoKICAgICAgICAgIGUudHlwZSA9IDEsIGUuY2FsbGJhY2sgPSAiYWJvdXRfd3BzIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJzcGxpdF9saW5lIjoKICAgICAgICAgIGUudHlwZSA9IDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY3VzdG9tIjoKICAgICAgICAgIGUudHlwZSA9IDMsIGcoZSwgIndwc2NvbmZpZ19vdGhlcl9tZW51X2J0bl8iICsgdCksIHcucHVzaChlKTsKICAgICAgfQogICAgfSksIHcubGVuZ3RoICYmIChFIHx8IFQpICYmIChtLml0ZW1zID0gdyk7CiAgfQoKICByLnVybCA9IHIudXJsIHx8IHIud3BzVXJsOwogIHZhciB5ID0gW107CgogIGlmICgobCA9PT0gcy5zaW1wbGUgfHwgZCAmJiAhMSA9PT0gZC5pc1Nob3dUb3BBcmVhKSAmJiB5LnB1c2goInNpbXBsZSIsICJoaWRlY21iIiksIHIuZGVidWcgJiYgeS5wdXNoKCJkZWJ1Z2dlciIpLCByLnVybCAmJiB5Lmxlbmd0aCAmJiAoci51cmwgPSByLnVybCArIChyLnVybC5pbmRleE9mKCI/IikgPj0gMCA/ICImIiA6ICI/IikgKyB5LmpvaW4oIiYiKSksIGQgJiYgKGQuaXNQYXJlbnRGdWxsc2NyZWVuIHx8IGQuaXNCcm93c2VyVmlld0Z1bGxzY3JlZW4pICYmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJmdWxsc2NyZWVuY2hhbmdlIiwgTiksIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UiLCBOKSwgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW96ZnVsbHNjcmVlbmNoYW5nZSIsIE4pKSwgci53b3JkT3B0aW9ucyAmJiAoci53cHNPcHRpb25zID0gci53b3JkT3B0aW9ucyksIHIuZXhjZWxPcHRpb25zICYmIChyLmV0T3B0aW9ucyA9IHIuZXhjZWxPcHRpb25zKSwgci5wcHRPcHRpb25zICYmIChyLndwcE9wdGlvbnMgPSByLnBwdE9wdGlvbnMpLCAib2JqZWN0IiA9PSBfdHlwZW9mKGMucHJpbnQpKSB7CiAgICB2YXIgayA9ICJ3cHNjb25maWdfcHJpbnQiOwogICAgImZ1bmN0aW9uIiA9PSB0eXBlb2YgYy5wcmludC5zdWJzY3JpYmUgJiYgKGNba10gPSBjLnByaW50LnN1YnNjcmliZSwgci5wcmludCA9IHsKICAgICAgY2FsbGJhY2s6IGsKICAgIH0sIHZvaWQgMCAhPT0gYy5wcmludC5jdXN0b20gJiYgKHIucHJpbnQuY3VzdG9tID0gYy5wcmludC5jdXN0b20pKSwgZGVsZXRlIGMucHJpbnQ7CiAgfQoKICAiZnVuY3Rpb24iID09IHR5cGVvZiBjLmV4cG9ydFBkZiAmJiAoY1trID0gIndwc2NvbmZpZ19leHBvcnRfcGRmIl0gPSBjLmV4cG9ydFBkZiwgci5leHBvcnRQZGYgPSB7CiAgICBjYWxsYmFjazogawogIH0sIGRlbGV0ZSBjLmV4cG9ydFBkZik7CiAgcmV0dXJuIHIuY29tbWFuZEJhcnMgJiYgQyhyLmNvbW1hbmRCYXJzLCAhMSksIF9lKF9lKHt9LCByKSwgewogICAgc3Vic2NyaXB0aW9uczogYwogIH0pOwp9LAogICAgXyA9IGZ1bmN0aW9uIF8oZSkgewogIHZvaWQgMCA9PT0gZSAmJiAoZSA9ICIiKTsKICB2YXIgdCA9ICIiOwoKICBpZiAoIXQgJiYgZSkgewogICAgdmFyIG4gPSBlLnRvTG93ZXJDYXNlKCk7CiAgICAtMSAhPT0gbi5pbmRleE9mKCIvb2ZmaWNlL3MvIikgJiYgKHQgPSBpLnNwcmVhZHNoZWV0KSwgLTEgIT09IG4uaW5kZXhPZigiL29mZmljZS93LyIpICYmICh0ID0gaS53cml0ZXIpLCAtMSAhPT0gbi5pbmRleE9mKCIvb2ZmaWNlL3AvIikgJiYgKHQgPSBpLnByZXNlbnRhdGlvbiksIC0xICE9PSBuLmluZGV4T2YoIi9vZmZpY2UvZi8iKSAmJiAodCA9IGkucGRmKTsKICB9CgogIGlmICghdCkgewogICAgdmFyIHIgPSBlLm1hdGNoKC9bXD8mXXR5cGU9KFthLXpdKykvKSB8fCBbXTsKICAgIHQgPSBvW3JbMV1dIHx8ICIiOwogIH0KCiAgcmV0dXJuIHQ7Cn07CgpmdW5jdGlvbiBDKGUsIHQpIHsKICB2b2lkIDAgPT09IHQgJiYgKHQgPSAhMCk7CiAgdmFyIG4gPSBlLm1hcChmdW5jdGlvbiAoZSkgewogICAgdmFyIHQgPSBlLmF0dHJpYnV0ZXM7CgogICAgaWYgKCFBcnJheS5pc0FycmF5KHQpKSB7CiAgICAgIHZhciBuID0gW107CgogICAgICBmb3IgKHZhciByIGluIHQpIHsKICAgICAgICBpZiAodC5oYXNPd25Qcm9wZXJ0eShyKSkgewogICAgICAgICAgdmFyIGEgPSB7CiAgICAgICAgICAgIG5hbWU6IHIsCiAgICAgICAgICAgIHZhbHVlOiB0W3JdCiAgICAgICAgICB9OwogICAgICAgICAgbi5wdXNoKGEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZS5hdHRyaWJ1dGVzID0gbjsKICAgIH0KCiAgICByZXR1cm4gZTsKICB9KTsKICByZXR1cm4gdCAmJiBoKHsKICAgIGRhdGE6IG4sCiAgICBldmVudE5hbWU6ICJzZXRDb21tYW5kQmFycyIKICB9KSwgbjsKfQoKdmFyIFMgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLAogICAgRSA9IC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUG9kfEJsYWNrQmVycnl8aVBhZC9pLnRlc3QoUyksCiAgICBUID0gZnVuY3Rpb24gKCkgewogIHRyeSB7CiAgICByZXR1cm4gLTEgIT09IHdpbmRvdy5fcGFyZW50LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKCJmcm9tPXd4bWluaXByb2dyYW0iKTsKICB9IGNhdGNoIChlKSB7CiAgICByZXR1cm4gITE7CiAgfQp9KCk7CgpmdW5jdGlvbiBOKCkgewogIHZhciBlID0gewogICAgc3RhdHVzOiBjLnJlcXVlc3RGdWxsc2NyZWVuCiAgfSwKICAgICAgdCA9IGRvY3VtZW50LAogICAgICBuID0gdC5mdWxsc2NyZWVuRWxlbWVudCB8fCB0LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50IHx8IHQubW96RnVsbFNjcmVlbkVsZW1lbnQ7CiAgZS5zdGF0dXMgPSBuID8gYy5yZXF1ZXN0RnVsbHNjcmVlbiA6IGMuZXhpdEZ1bGxzY3JlZW4sIGgoewogICAgZGF0YTogZSwKICAgIGV2ZW50TmFtZTogImZ1bGxzY3JlZW5jaGFuZ2UiCiAgfSk7Cn0KCnZhciBQID0gMCwKICAgIEYgPSBuZXcgU2V0KCk7CgpmdW5jdGlvbiBMKGUpIHsKICByZXR1cm4gUCArPSAxLCAhZSAmJiBmdW5jdGlvbiAoZSkgewogICAgRi5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0KGUpOwogICAgfSk7CiAgfShQKSwgUDsKfQoKZnVuY3Rpb24gQSgpIHsKICB2YXIgZSA9IG5ldyBFcnJvcigiIik7CiAgcmV0dXJuIChlLnN0YWNrIHx8IGUubWVzc2FnZSB8fCAiIikuc3BsaXQoIlxuIikuc2xpY2UoMikuam9pbigiXG4iKTsKfQoKZnVuY3Rpb24gRChhLCBvKSB7CiAgdmFyIHMsCiAgICAgIGMgPSB0aGlzLAogICAgICB1ID0gby5FdmVudHMsCiAgICAgIGwgPSBvLkVudW0sCiAgICAgIHAgPSBvLlByb3BzLAogICAgICBmID0gcFswXSwKICAgICAgdiA9IHBbMV0sCiAgICAgIGIgPSB7CiAgICBvYmpJZDogUAogIH07CgogIHN3aXRjaCAoZnVuY3Rpb24gdChuLCByLCBhKSB7CiAgICB2YXIgaSA9IHIuc2xpY2UoMCk7CgogICAgdmFyIG8gPSBmdW5jdGlvbiBvKCkgewogICAgICB2YXIgciA9IGkuc2hpZnQoKTsKICAgICAgIXIuYWxpYXMgJiYgfkIuaW5kZXhPZihyLnByb3ApICYmIGkucHVzaChfZShfZSh7fSwgciksIHsKICAgICAgICBhbGlhczogci5wcm9wICsgIkFzeW5jIgogICAgICB9KSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCByLmFsaWFzIHx8IHIucHJvcCwgewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgdmFyIGkgPSB0aGlzLAogICAgICAgICAgICAgIG8gPSAxID09PSByLmNhY2hlLAogICAgICAgICAgICAgIHMgPSBvICYmIHRoaXNbIl9fIiArIHIucHJvcCArICJDYWNoZVZhbHVlIl07CgogICAgICAgICAgaWYgKCFzKSB7CiAgICAgICAgICAgIHZhciBjID0gQSgpLAogICAgICAgICAgICAgICAgdSA9IEwobyksCiAgICAgICAgICAgICAgICBsID0gZnVuY3Rpb24gbCgpIHsKICAgICAgICAgICAgICBmb3IgKHZhciB0LCBpID0gW10sIG8gPSAwOyBvIDwgYXJndW1lbnRzLmxlbmd0aDsgbysrKSB7CiAgICAgICAgICAgICAgICBpW29dID0gYXJndW1lbnRzW29dOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdm9pZCAwICE9PSByLmNhbGxlciA/IGZ1bmN0aW9uIHQobiwgciwgYSkgewogICAgICAgICAgICAgICAgdmFyIGkgPSByLnNsaWNlKDApOwoKICAgICAgICAgICAgICAgIHZhciBvID0gZnVuY3Rpb24gbygpIHsKICAgICAgICAgICAgICAgICAgdmFyIHIgPSBpLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICAgICFyLmFsaWFzICYmIH5CLmluZGV4T2Yoci5wcm9wKSAmJiBpLnB1c2goX2UoX2Uoe30sIHIpLCB7CiAgICAgICAgICAgICAgICAgICAgYWxpYXM6IHIucHJvcCArICJBc3luYyIKICAgICAgICAgICAgICAgICAgfSkpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgci5hbGlhcyB8fCByLnByb3AsIHsKICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gMSA9PT0gci5jYWNoZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gaSAmJiB0aGlzWyJfXyIgKyByLnByb3AgKyAiQ2FjaGVWYWx1ZSJdOwoKICAgICAgICAgICAgICAgICAgICAgIGlmICghbykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IEEoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBMKGkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGZ1bmN0aW9uIHUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSwgaSA9IFtdLCBvID0gMDsgbyA8IGFyZ3VtZW50cy5sZW5ndGg7IG8rKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaVtvXSA9IGFyZ3VtZW50c1tvXTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCAhPT0gci5jYWxsZXIgPyB0KGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpJZDogTCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgYVtyLmNhbGxlcl0sIGEpIDogZSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBIKHUsIGUsICJhcGkuY2FsbGVyIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqOiB1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE9iaklkOiBuLm9iaklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqSWQ6IGUub2JqSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wOiByLnByb3AKICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBzKSwgZTsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1Lm9iaklkID0gLTEsIHZvaWQgMCAhPT0gci5nZXR0ZXIgJiYgKHUub2JqSWQgPSBjLCB0KHUsIGFbci5nZXR0ZXJdLCBhKSksIEgobiwgdSwgImFwaS5nZXR0ZXIiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqSWQ6IG4ub2JqSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqSWQ6IHUub2JqSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogci5wcm9wCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgZVsiX18iICsgci5wcm9wICsgIkNhY2hlVmFsdWUiXTsKICAgICAgICAgICAgICAgICAgICAgICAgfSksIGkgJiYgKHRoaXNbIl9fIiArIHIucHJvcCArICJDYWNoZVZhbHVlIl0gPSB1KSwgdTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbzsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGUpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciB0ID0gQSgpOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEgobiwge30sICJhcGkuc2V0dGVyIiwgewogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqSWQ6IG4ub2JqSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIG9iaklkOiAtMSwKICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogci5wcm9wCiAgICAgICAgICAgICAgICAgICAgICB9LCB0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBmb3IgKDsgaS5sZW5ndGg7KSB7CiAgICAgICAgICAgICAgICAgIG8oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KHQgPSB7CiAgICAgICAgICAgICAgICBvYmpJZDogTCgpCiAgICAgICAgICAgICAgfSwgYVtyLmNhbGxlcl0sIGEpIDogdCA9IHt9OwogICAgICAgICAgICAgIHJldHVybiBIKGwsIHQsICJhcGkuY2FsbGVyIiwgewogICAgICAgICAgICAgICAgb2JqOiBsLAogICAgICAgICAgICAgICAgYXJnczogaSwKICAgICAgICAgICAgICAgIHBhcmVudE9iaklkOiBuLm9iaklkLAogICAgICAgICAgICAgICAgb2JqSWQ6IHQub2JqSWQsCiAgICAgICAgICAgICAgICBwcm9wOiByLnByb3AKICAgICAgICAgICAgICB9LCBjKSwgdDsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHJldHVybiBsLm9iaklkID0gLTEsIHZvaWQgMCAhPT0gci5nZXR0ZXIgJiYgKGwub2JqSWQgPSB1LCB0KGwsIGFbci5nZXR0ZXJdLCBhKSksIEgobiwgbCwgImFwaS5nZXR0ZXIiLCB7CiAgICAgICAgICAgICAgcGFyZW50T2JqSWQ6IG4ub2JqSWQsCiAgICAgICAgICAgICAgb2JqSWQ6IGwub2JqSWQsCiAgICAgICAgICAgICAgcHJvcDogci5wcm9wCiAgICAgICAgICAgIH0sIGMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBkZWxldGUgaVsiX18iICsgci5wcm9wICsgIkNhY2hlVmFsdWUiXTsKICAgICAgICAgICAgfSksIG8gJiYgKHRoaXNbIl9fIiArIHIucHJvcCArICJDYWNoZVZhbHVlIl0gPSBsKSwgbDsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gczsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGUpIHsKICAgICAgICAgIHZhciB0ID0gQSgpOwogICAgICAgICAgcmV0dXJuIEgobiwge30sICJhcGkuc2V0dGVyIiwgewogICAgICAgICAgICB2YWx1ZTogZSwKICAgICAgICAgICAgcGFyZW50T2JqSWQ6IG4ub2JqSWQsCiAgICAgICAgICAgIG9iaklkOiAtMSwKICAgICAgICAgICAgcHJvcDogci5wcm9wCiAgICAgICAgICB9LCB0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBmb3IgKDsgaS5sZW5ndGg7KSB7CiAgICAgIG8oKTsKICAgIH0KICB9KGIsIGYsIHYpLCBiLkV2ZW50cyA9IHUsIGIuRW51bSA9IGwsIGEuRW51bSA9IGIuRW51bSwgYS5FdmVudHMgPSBiLkV2ZW50cywgYS5Qcm9wcyA9IHAsIF8oYS51cmwpKSB7CiAgICBjYXNlIGkud3JpdGVyOgogICAgICBhLldvcmRBcHBsaWNhdGlvbiA9IGEuV3BzQXBwbGljYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGI7CiAgICAgIH07CgogICAgICBicmVhazsKCiAgICBjYXNlIGkuc3ByZWFkc2hlZXQ6CiAgICAgIGEuRXhjZWxBcHBsaWNhdGlvbiA9IGEuRXRBcHBsaWNhdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gYjsKICAgICAgfTsKCiAgICAgIGJyZWFrOwoKICAgIGNhc2UgaS5wcmVzZW50YXRpb246CiAgICAgIGEuUFBUQXBwbGljYXRpb24gPSBhLldwcEFwcGxpY2F0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBiOwogICAgICB9OwoKICAgICAgYnJlYWs7CgogICAgY2FzZSBpLnBkZjoKICAgICAgYS5QREZBcHBsaWNhdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gYjsKICAgICAgfTsKCiAgfQoKICBhLkFwcGxpY2F0aW9uID0gYiwgYS5GcmVlID0gZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBJKCJhcGkuZnJlZSIsIHsKICAgICAgb2JqSWQ6IGUKICAgIH0sICIiKTsKICB9LCBhLlN0YWNrID0gYi5TdGFjayA9IChzID0gZnVuY3Rpb24gcyhlKSB7CiAgICBhICYmIGEuRnJlZShlKTsKICB9LCBmdW5jdGlvbiAoKSB7CiAgICB2YXIgZSA9IFtdLAogICAgICAgIHQgPSBmdW5jdGlvbiB0KF90KSB7CiAgICAgIGUucHVzaChfdCk7CiAgICB9OwoKICAgIHJldHVybiBGLmFkZCh0KSwgewogICAgICBFbmQ6IGZ1bmN0aW9uIEVuZCgpIHsKICAgICAgICBzKGUpLCBGLmRlbGV0ZSh0KTsKICAgICAgfQogICAgfTsKICB9KTsKICB2YXIgbSA9IHt9OwogIHIuYWRkKGZ1bmN0aW9uIChlKSB7CiAgICByZXR1cm4gdChjLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgdCwgYSwgaSwgbywgczsKICAgICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKG4pIHsKICAgICAgICBzd2l0Y2ggKG4ubGFiZWwpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcmV0dXJuIGQoZSkgPyBbMl0gOiAiYXBpLmV2ZW50IiA9PT0gKHQgPSByLnBhcnNlKGUuZGF0YSkpLmV2ZW50TmFtZSAmJiB0LmRhdGEgPyAoYSA9IHQuZGF0YSwgaSA9IGEuZXZlbnROYW1lLCBvID0gYS5kYXRhLCAocyA9IG1baV0pID8gWzQsIHMobyldIDogWzMsIDJdKSA6IFszLCAyXTsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG4uc2VudCgpLCBuLmxhYmVsID0gMjsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJldHVybiBbMl07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0pLCBiLlN1YiA9IHt9OwoKICB2YXIgZyA9IGZ1bmN0aW9uIGcoZSkgewogICAgdmFyIHQgPSB1W2VdOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIuU3ViLCB0LCB7CiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGUpIHsKICAgICAgICBtW3RdID0gZSwgaCh7CiAgICAgICAgICBldmVudE5hbWU6ICJhcGkuZXZlbnQucmVnaXN0ZXIiLAogICAgICAgICAgZGF0YTogewogICAgICAgICAgICBldmVudE5hbWU6IHQsCiAgICAgICAgICAgIHJlZ2lzdGVyOiAhIWUsCiAgICAgICAgICAgIG9iaklkOiBQICs9IDEKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgZm9yICh2YXIgdyBpbiB1KSB7CiAgICBnKHcpOwogIH0KfQoKdmFyIEIgPSBbIkV4cG9ydEFzRml4ZWRGb3JtYXQiLCAiR2V0T3BlcmF0b3JzSW5mbyIsICJJbXBvcnREYXRhSW50b0ZpZWxkcyIsICJSZXBsYWNlVGV4dCIsICJSZXBsYWNlQm9va21hcmsiLCAiR2V0Qm9va21hcmtUZXh0IiwgIkdldENvbW1lbnRzIl07CgpmdW5jdGlvbiBWKHQsIG4sIHIpIHsKICB2YXIgYSA9IG4uc2xpY2UoMCk7CgogIHZhciBpID0gZnVuY3Rpb24gaSgpIHsKICAgIHZhciBuID0gYS5zaGlmdCgpOwoKICAgIGlmICghbi5hbGlhcyAmJiB+Qi5pbmRleE9mKG4ucHJvcCkpIHsKICAgICAgYS5wdXNoKF9lKF9lKHt9LCBuKSwgewogICAgICAgIGFsaWFzOiBuLnByb3AgKyAiQXN5bmMiCiAgICAgIH0pKTsKICAgIH0KCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgbi5hbGlhcyB8fCBuLnByb3AsIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIGUgPSB0aGlzOwogICAgICAgIHZhciBhID0gbi5jYWNoZSA9PT0gMTsKICAgICAgICB2YXIgaSA9IGEgJiYgdGhpc1siX18iICsgbi5wcm9wICsgIkNhY2hlVmFsdWUiXTsKCiAgICAgICAgaWYgKCFpKSB7CiAgICAgICAgICB2YXIgbyA9IEEoKTsKICAgICAgICAgIHZhciBzID0gTChhKTsKCiAgICAgICAgICB2YXIgYyA9IGZ1bmN0aW9uIGMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSBbXSwgYSA9IDAsIGk7IGEgPCBhcmd1bWVudHMubGVuZ3RoOyBhKyspIHsKICAgICAgICAgICAgICBlW2FdID0gYXJndW1lbnRzW2FdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobi5jYWxsZXIgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIGkgPSB7CiAgICAgICAgICAgICAgICBvYmpJZDogTCgpCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBWKGksIHJbbi5jYWxsZXJdLCByKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpID0ge307CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBIKHUsIGksICJhcGkuY2FsbGVyIiwgewogICAgICAgICAgICAgIG9iajogdSwKICAgICAgICAgICAgICBhcmdzOiBlLAogICAgICAgICAgICAgIHBhcmVudE9iaklkOiB0Lm9iaklkLAogICAgICAgICAgICAgIG9iaklkOiBpLm9iaklkLAogICAgICAgICAgICAgIHByb3A6IG4ucHJvcAogICAgICAgICAgICB9LCBvKSwgaTsKICAgICAgICAgIH07CgogICAgICAgICAgdmFyIHUgPSBjOwogICAgICAgICAgdS5vYmpJZCA9IC0xOwoKICAgICAgICAgIGlmIChuLmdldHRlciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHUub2JqSWQgPSBzOwogICAgICAgICAgICBWKHUsIHJbbi5nZXR0ZXJdLCByKTsKICAgICAgICAgIH0KCiAgICAgICAgICBIKHQsIHUsICJhcGkuZ2V0dGVyIiwgewogICAgICAgICAgICBwYXJlbnRPYmpJZDogdC5vYmpJZCwKICAgICAgICAgICAgb2JqSWQ6IHUub2JqSWQsCiAgICAgICAgICAgIHByb3A6IG4ucHJvcAogICAgICAgICAgfSwgbywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBkZWxldGUgZVsiX18iICsgbi5wcm9wICsgIkNhY2hlVmFsdWUiXTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChhKSB7CiAgICAgICAgICAgIHRoaXNbIl9fIiArIG4ucHJvcCArICJDYWNoZVZhbHVlIl0gPSB1OwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB1OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGUpIHsKICAgICAgICB2YXIgciA9IEEoKTsKICAgICAgICByZXR1cm4gSCh0LCB7fSwgImFwaS5zZXR0ZXIiLCB7CiAgICAgICAgICB2YWx1ZTogZSwKICAgICAgICAgIHBhcmVudE9iaklkOiB0Lm9iaklkLAogICAgICAgICAgb2JqSWQ6IC0xLAogICAgICAgICAgcHJvcDogbi5wcm9wCiAgICAgICAgfSwgcik7CiAgICAgIH0KICAgIH0pOwogIH07CgogIHdoaWxlIChhLmxlbmd0aCkgewogICAgaSgpOwogIH0KfQoKZnVuY3Rpb24gSChlLCB0LCBuLCByLCBhLCBpKSB7CiAgdmFyIG8sCiAgICAgIHMgPSAoZS5kb25lID8gZS5kb25lKCkgOiBQcm9taXNlLnJlc29sdmUoKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbyB8fCAobyA9IEkobiwgciwgYSwgaSkpLCBvOwogIH0pOwogIHQuZG9uZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzOwogIH0sIHQudGhlbiA9IGZ1bmN0aW9uIChlLCBuKSB7CiAgICByZXR1cm4gci5vYmpJZCA+PSAwID8gKHQudGhlbiA9IG51bGwsIHQuY2F0Y2ggPSBudWxsLCBzLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBlKHQpOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIG4oZSk7CiAgICB9KSkgOiBzLnRoZW4oZSwgbik7CiAgfSwgdC5jYXRjaCA9IGZ1bmN0aW9uIChlKSB7CiAgICByZXR1cm4gcy5jYXRjaChlKTsKICB9LCB0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gSSgiYXBpLmZyZWUiLCB7CiAgICAgIG9iaklkOiB0Lm9iaklkCiAgICB9LCAiIik7CiAgfTsKfQoKdmFyIE0gPSBudWxsLAogICAgUiA9IHsKICBmaWxlT3BlbjogImZpbGVPcGVuIiwKICB0YWJTd2l0Y2g6ICJ0YWJTd2l0Y2giLAogIGZpbGVTYXZlZDogImZpbGVTYXZlZCIsCiAgZmlsZVN0YXR1czogImZpbGVTdGF0dXMiLAogIGZ1bGxzY3JlZW5DaGFuZ2U6ICJmdWxsc2NyZWVuQ2hhbmdlIiwKICBlcnJvcjogImVycm9yIiwKICBzdGFnZTogInN0YWdlIgp9LAogICAgVyA9IHsKICBnZXRUb2tlbjogImFwaS5nZXRUb2tlbiIsCiAgb25Ub2FzdDogImV2ZW50LnRvYXN0IiwKICBvbkh5cGVyTGlua09wZW46ICJldmVudC5oeXBlckxpbmtPcGVuIiwKICBnZXRDbGlwYm9hcmREYXRhOiAiYXBpLmdldENsaXBib2FyZERhdGEiCn07CgpmdW5jdGlvbiB6KGEsIGksIG8sIHMsIGMsIHUsIGwpIHsKICB2YXIgcCA9IHRoaXM7CiAgdm9pZCAwID09PSBvICYmIChvID0ge30pOwogIHIuYWRkKGZ1bmN0aW9uIChmKSB7CiAgICByZXR1cm4gdChwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgdCwgcCwgdiwgYiwgbSwgZywgdywgeSwgaywgaiwgSSwgTywgeCwgXywgQywgUywgRSwgVCwgTjsKCiAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgc3dpdGNoIChuLmxhYmVsKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHJldHVybiBkKGYpID8gWzJdIDogKHQgPSByLnBhcnNlKGYuZGF0YSksIHAgPSB0LmV2ZW50TmFtZSwgdiA9IHZvaWQgMCA9PT0gcCA/ICIiIDogcCwgYiA9IHQuZGF0YSwgbSA9IHZvaWQgMCA9PT0gYiA/IG51bGwgOiBiLCBnID0gdC51cmwsIHcgPSB2b2lkIDAgPT09IGcgPyBudWxsIDogZywgLTEgIT09IFsid3BzLmpzc2RrLmFwaSJdLmluZGV4T2YodikgPyBbMl0gOiAicmVhZHkiICE9PSB2ID8gWzMsIDFdIDogKGgoewogICAgICAgICAgICAgIGV2ZW50TmFtZTogInNldENvbmZpZyIsCiAgICAgICAgICAgICAgZGF0YTogX2UoX2Uoe30sIG8pLCB7CiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhLnZlcnNpb24KICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KSwgYS50b2tlbkRhdGEgJiYgYS5zZXRUb2tlbihfZShfZSh7fSwgYS50b2tlbkRhdGEpLCB7CiAgICAgICAgICAgICAgaGFzUmVmcmVzaFRva2VuQ29uZmlnOiAhIW8ucmVmcmVzaFRva2VuCiAgICAgICAgICAgIH0pKSwgYy5hcGlSZWFkeVNlbmRlZCAmJiBoKHsKICAgICAgICAgICAgICBldmVudE5hbWU6ICJhcGkucmVhZHkiCiAgICAgICAgICAgIH0pLCBhLmlmcmFtZVJlYWR5ID0gITAsIFszLCAxN10pKTsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHJldHVybiAiZXJyb3IiICE9PSB2ID8gWzMsIDJdIDogKGkuZW1pdChSLmVycm9yLCBtKSwgWzMsIDE3XSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXR1cm4gIm9wZW4ucmVzdWx0IiAhPT0gdiA/IFszLCAzXSA6ICh2b2lkIDAgIT09IChudWxsID09PSAoRSA9IG51bGwgPT0gbSA/IHZvaWQgMCA6IG0uZmlsZUluZm8pIHx8IHZvaWQgMCA9PT0gRSA/IHZvaWQgMCA6IEUub2ZmaWNlVmVyc2lvbikgJiYgKGEubWFpblZlcnNpb24gPSBtLmZpbGVJbmZvLm9mZmljZVZlcnNpb24sIGNvbnNvbGUubG9nKCJXZWJPZmZpY2VTREsgTWFpbiBWZXJzaW9uOiBWIiArIGEubWFpblZlcnNpb24pKSwgaS5lbWl0KFIuZmlsZU9wZW4sIG0pLCBbMywgMTddKTsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiAiZmlsZS5zYXZlZCIgIT09IHYgPyBbMywgNF0gOiAoaS5lbWl0KFIuZmlsZVN0YXR1cywgbSksIGkuZW1pdChSLmZpbGVTYXZlZCwgbSksIFszLCAxN10pOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgcmV0dXJuICJ0YWIuc3dpdGNoIiAhPT0gdiA/IFszLCA1XSA6IChpLmVtaXQoUi50YWJTd2l0Y2gsIG0pLCBbMywgMTddKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHJldHVybiAiYXBpLnNjcm9sbCIgIT09IHYgPyBbMywgNl0gOiAod2luZG93LnNjcm9sbFRvKG0ueCwgbS55KSwgWzMsIDE3XSk7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBpZiAodiAhPT0gVy5nZXRUb2tlbikgcmV0dXJuIFszLCAxMV07CiAgICAgICAgICAgIHkgPSB7CiAgICAgICAgICAgICAgdG9rZW46ICExCiAgICAgICAgICAgIH0sIG4ubGFiZWwgPSA3OwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgcmV0dXJuIG4udHJ5cy5wdXNoKFs3LCA5LCwgMTBdKSwgWzQsIGMucmVmcmVzaFRva2VuKCldOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgcmV0dXJuIHkgPSBuLnNlbnQoKSwgWzMsIDEwXTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIHJldHVybiBrID0gbi5zZW50KCksIGNvbnNvbGUuZXJyb3IoInJlZnJlc2hUb2tlbjogIiArIChrIHx8ICJmYWlsIHRvIGdldCIpKSwgWzMsIDEwXTsKCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICByZXR1cm4gaCh7CiAgICAgICAgICAgICAgZXZlbnROYW1lOiBXLmdldFRva2VuICsgIi5yZXBseSIsCiAgICAgICAgICAgICAgZGF0YTogeQogICAgICAgICAgICB9KSwgWzMsIDE3XTsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBpZiAodiAhPT0gVy5nZXRDbGlwYm9hcmREYXRhKSByZXR1cm4gWzMsIDE2XTsKICAgICAgICAgICAgaiA9IHsKICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICBodG1sOiAiIgogICAgICAgICAgICB9LCBuLmxhYmVsID0gMTI7CgogICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgcmV0dXJuIG4udHJ5cy5wdXNoKFsxMiwgMTQsLCAxNV0pLCBbNCwgYy5nZXRDbGlwYm9hcmREYXRhKCldOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIHJldHVybiBqID0gbi5zZW50KCksIFszLCAxNV07CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgcmV0dXJuIEkgPSBuLnNlbnQoKSwgY29uc29sZS5lcnJvcigiZ2V0Q2xpcGJvYXJkRGF0YTogIiArIChJIHx8ICJmYWlsIHRvIGdldCIpKSwgWzMsIDE1XTsKCiAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICByZXR1cm4gaCh7CiAgICAgICAgICAgICAgZXZlbnROYW1lOiBXLmdldENsaXBib2FyZERhdGEgKyAiLnJlcGx5IiwKICAgICAgICAgICAgICBkYXRhOiBqCiAgICAgICAgICAgIH0pLCBbMywgMTddOwoKICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIHYgPT09IFcub25Ub2FzdCA/IGMub25Ub2FzdChtKSA6IHYgPT09IFcub25IeXBlckxpbmtPcGVuID8gYy5vbkh5cGVyTGlua09wZW4obSkgOiAic3RhZ2UiID09PSB2ID8gaS5lbWl0KFIuc3RhZ2UsIG0pIDogImV2ZW50LmNhbGxiYWNrIiA9PT0gdiA/IChPID0gbS5ldmVudE5hbWUsIHggPSBtLmRhdGEsIF8gPSBPLCAiZnVsbFNjcmVlbkNoYW5nZSIgPT09IE8gJiYgKF8gPSBSLmZ1bGxzY3JlZW5DaGFuZ2UpLCAoKG51bGwgPT09IChUID0gby5jb21tb25PcHRpb25zKSB8fCB2b2lkIDAgPT09IFQgPyB2b2lkIDAgOiBULmlzQnJvd3NlclZpZXdGdWxsc2NyZWVuKSB8fCAobnVsbCA9PT0gKE4gPSBvLmNvbW1vbk9wdGlvbnMpIHx8IHZvaWQgMCA9PT0gTiA/IHZvaWQgMCA6IE4uaXNQYXJlbnRGdWxsc2NyZWVuKSkgJiYgImZ1bGxzY3JlZW5jaGFuZ2UiID09PSBfID8gKEMgPSB4LnN0YXR1cywgUyA9IHguaXNEaXNwYXRjaEV2ZW50LCBvLmNvbW1vbk9wdGlvbnMuaXNCcm93c2VyVmlld0Z1bGxzY3JlZW4gPyBmdW5jdGlvbiAoZSwgdCwgbiwgcikgewogICAgICAgICAgICAgIDAgPT09IGUgPyB0LnN0eWxlID0gInBvc2l0aW9uOiBzdGF0aWM7IHdpZHRoOiAiICsgbi53aWR0aCArICI7IGhlaWdodDogIiArIG4uaGVpZ2h0IDogMSA9PT0gZSAmJiAodC5zdHlsZSA9ICJwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCUiKSwgciAmJiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgWyJmdWxsc2NyZWVuIiwgImZ1bGxzY3JlZW5FbGVtZW50Il0uZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsIHQsIHsKICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIWUuc3RhdHVzOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiAhMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgQ3VzdG9tRXZlbnQoImZ1bGxzY3JlZW5jaGFuZ2UiKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQodCk7CiAgICAgICAgICAgICAgfSh7CiAgICAgICAgICAgICAgICBzdGF0dXM6IGUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfShDLCB1LCBsLCBTKSA6IG8uY29tbW9uT3B0aW9ucy5pc1BhcmVudEZ1bGxzY3JlZW4gJiYgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICAgICAgICB2YXIgciA9IG4ubW91bnQgJiYgMSA9PT0gbi5tb3VudC5ub2RlVHlwZSA/IG4ubW91bnQgOiB0OwoKICAgICAgICAgICAgICBpZiAoMCA9PT0gZSkgewogICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICBpID0gYS5leGl0RnVsbHNjcmVlbiB8fCBhLm1vekNhbmNlbEZ1bGxTY3JlZW4gfHwgYS5tc0V4aXRGdWxsc2NyZWVuIHx8IGEud2Via2l0Q2FuY2VsRnVsbFNjcmVlbiB8fCBhLndlYmtpdEV4aXRGdWxsc2NyZWVuOwogICAgICAgICAgICAgICAgaS5jYWxsKGRvY3VtZW50KTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKDEgPT09IGUpIHsKICAgICAgICAgICAgICAgIHZhciBvID0gci5yZXF1ZXN0RnVsbHNjcmVlbiB8fCByLm1velJlcXVlc3RGdWxsU2NyZWVuIHx8IHIubXNSZXF1ZXN0RnVsbHNjcmVlbiB8fCByLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuOwogICAgICAgICAgICAgICAgby5jYWxsKHIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfShDLCB1LCBvLmNvbW1vbk9wdGlvbnMuaXNQYXJlbnRGdWxsc2NyZWVuKSwgaS5lbWl0KF8sIHgpKSA6IGkuZW1pdChfLCB4KSkgOiAiYXBpLnJlYWR5IiA9PT0gdiAmJiBEKGEsIG0pLCBuLmxhYmVsID0gMTc7CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgcmV0dXJuICJmdW5jdGlvbiIgPT0gdHlwZW9mIHNbdl0gJiYgc1t2XShhLCB3IHx8IG0pLCBbMl07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0pOwp9CgpmdW5jdGlvbiBxKGUpIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHQpIHsKICAgIHZhciBuID0gZnVuY3Rpb24gbihhKSB7CiAgICAgIGQoYSkgfHwgci5wYXJzZShhLmRhdGEpLmV2ZW50TmFtZSA9PT0gZSAmJiAodCgpLCByLnJlbW92ZShuKSk7CiAgICB9OwoKICAgIHIuYWRkKG4pOwogIH0pOwp9CgpmdW5jdGlvbiBHKGUpIHsKICB2b2lkIDAgPT09IGUgJiYgKGUgPSB7fSksIE0gJiYgTS5kZXN0cm95KCk7CgogIHRyeSB7CiAgICB2YXIgaSA9IHgoZSksCiAgICAgICAgbyA9IGkuc3Vic2NyaXB0aW9ucywKICAgICAgICBzID0gdm9pZCAwID09PSBvID8ge30gOiBvLAogICAgICAgIGMgPSBpLm1vdW50LAogICAgICAgIGwgPSB2b2lkIDAgPT09IGMgPyBudWxsIDogYywKICAgICAgICBkID0gaS51cmwsCiAgICAgICAgcCA9IGkucmVmcmVzaFRva2VuLAogICAgICAgIGYgPSBpLm9uVG9hc3QsCiAgICAgICAgdiA9IGkub25IeXBlckxpbmtPcGVuLAogICAgICAgIG0gPSBpLmdldENsaXBib2FyZERhdGE7CiAgICBUID0gIm9yaWdpbiIsIEwgPSAoZC5tYXRjaCgvaHR0cHMqOlwvXC9bXlwvXSsvZykgfHwgW10pWzBdLCB1W1RdID0gTDsKICAgIHZhciB5ID0gYihkLCBsKSwKICAgICAgICBrID0gcSgicmVhZHkiKSwKICAgICAgICBqID0gcSgib3Blbi5yZXN1bHQiKSwKICAgICAgICBJID0gcSgiYXBpLnJlYWR5IiksCiAgICAgICAgTyA9IGwgPyB7CiAgICAgIHdpZHRoOiBsLmNsaWVudFdpZHRoICsgInB4IiwKICAgICAgaGVpZ2h0OiBsLmNsaWVudEhlaWdodCArICJweCIKICAgIH0gOiB7CiAgICAgIHdpZHRoOiAiMTAwdnciLAogICAgICBoZWlnaHQ6ICIxMDB2aCIKICAgIH07CiAgICBkZWxldGUgaS5tb3VudCwgZCAmJiBkZWxldGUgaS51cmwsIGRlbGV0ZSBpLnN1YnNjcmlwdGlvbnM7CgogICAgdmFyIF8gPSAoRSA9IEUgfHwgT2JqZWN0LmNyZWF0ZShudWxsKSwgewogICAgICBvbjogZnVuY3Rpb24gb24oZSwgdCkgewogICAgICAgIChFW2VdIHx8IChFW2VdID0gW10pKS5wdXNoKHQpOwogICAgICB9LAogICAgICBvZmY6IGZ1bmN0aW9uIG9mZihlLCB0KSB7CiAgICAgICAgRVtlXSAmJiBFW2VdLnNwbGljZShFW2VdLmluZGV4T2YodCkgPj4+IDAsIDEpOwogICAgICB9LAogICAgICBlbWl0OiBmdW5jdGlvbiBlbWl0KGUsIHQpIHsKICAgICAgICAoRVtlXSB8fCBbXSkuc2xpY2UoKS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUodCk7CiAgICAgICAgfSksIChFWyIqIl0gfHwgW10pLnNsaWNlKCkubWFwKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICBuKGUsIHQpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KSwKICAgICAgICBTID0gewogICAgICBhcGlSZWFkeVNlbmRlZDogITEKICAgIH07CgogICAgcmV0dXJuIE0gPSB7CiAgICAgIHVybDogZCwKICAgICAgaWZyYW1lOiB5LAogICAgICB2ZXJzaW9uOiAiMS4xLjEyIiwKICAgICAgaWZyYW1lUmVhZHk6ICExLAogICAgICB0b2tlbkRhdGE6IG51bGwsCiAgICAgIGNvbW1hbmRCYXJzOiBudWxsLAogICAgICB0YWJzOiB7CiAgICAgICAgZ2V0VGFiczogZnVuY3Rpb24gZ2V0VGFicygpIHsKICAgICAgICAgIHJldHVybiB0KHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChlLmxhYmVsKSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICByZXR1cm4gZS5zZW50KCksIFsyLCB3KHsKICAgICAgICAgICAgICAgICAgICBhcGk6ICJ0YWIuZ2V0VGFicyIKICAgICAgICAgICAgICAgICAgfSldOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHN3aXRjaFRhYjogZnVuY3Rpb24gc3dpdGNoVGFiKGUpIHsKICAgICAgICAgIHJldHVybiB0KHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgc3dpdGNoICh0LmxhYmVsKSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICByZXR1cm4gdC5zZW50KCksIFsyLCB3KHsKICAgICAgICAgICAgICAgICAgICBhcGk6ICJ0YWIuc3dpdGNoVGFiIiwKICAgICAgICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICAgICAgICB0YWJLZXk6IGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzZXRDb29wZXJVc2VyQ29sb3I6IGZ1bmN0aW9uIHNldENvb3BlclVzZXJDb2xvcihlKSB7CiAgICAgICAgcmV0dXJuIHQodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJldHVybiB0LnNlbnQoKSwgWzIsIHcoewogICAgICAgICAgICAgICAgICBhcGk6ICJzZXRDb29wZXJVc2VyQ29sb3IiLAogICAgICAgICAgICAgICAgICBhcmdzOiBlCiAgICAgICAgICAgICAgICB9KV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9LAogICAgICBzZXRUb2tlbjogZnVuY3Rpb24gc2V0VG9rZW4oZSkgewogICAgICAgIHJldHVybiB0KHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbih0aGlzLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICBzd2l0Y2ggKHQubGFiZWwpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGtdOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICByZXR1cm4gdC5zZW50KCksIE0udG9rZW5EYXRhID0gZSwgaCh7CiAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogInNldFRva2VuIiwKICAgICAgICAgICAgICAgICAgZGF0YTogZQogICAgICAgICAgICAgICAgfSksIFsyXTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIHJlYWR5OiBmdW5jdGlvbiByZWFkeSgpIHsKICAgICAgICByZXR1cm4gdCh0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgc3dpdGNoIChlLmxhYmVsKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIFMuYXBpUmVhZHlTZW5kZWQgPyBbMywgMl0gOiBbNCwgal07CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIGUuc2VudCgpLCBTLmFwaVJlYWR5U2VuZGVkID0gITAsIGgoewogICAgICAgICAgICAgICAgICBldmVudE5hbWU6ICJhcGkucmVhZHkiCiAgICAgICAgICAgICAgICB9KSwgZS5sYWJlbCA9IDI7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBbNCwgSV07CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBlLnNlbnQoKSwgWzIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZShudWxsID09IE0gPyB2b2lkIDAgOiBNLkFwcGxpY2F0aW9uKTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9KV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9LAogICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICAgIHkuZGVzdHJveSgpLCByLmVtcHR5KCksIE0gPSBudWxsLCBGID0gbmV3IFNldCgpLCBQID0gMCwgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZnVsbHNjcmVlbmNoYW5nZSIsIE4pOwogICAgICB9LAogICAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICAgIHJldHVybiB0KHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbih0aGlzLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBzd2l0Y2ggKGUubGFiZWwpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGtdOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICByZXR1cm4gZS5zZW50KCksIFsyLCBnKHsKICAgICAgICAgICAgICAgICAgYXBpOiAic2F2ZSIKICAgICAgICAgICAgICAgIH0pXTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIHNldENvbW1hbmRCYXJzOiBmdW5jdGlvbiBzZXRDb21tYW5kQmFycyhlKSB7CiAgICAgICAgcmV0dXJuIHQodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJldHVybiB0LnNlbnQoKSwgQyhlKSwgWzJdOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgdXBkYXRlQ29uZmlnOiBmdW5jdGlvbiB1cGRhdGVDb25maWcoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgPT09IGUgJiYgKGUgPSB7fSksIHQodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJldHVybiB0LnNlbnQoKSwgZS5jb21tYW5kQmFycyA/IChjb25zb2xlLndhcm4oIkRlcHJlY2F0ZWQ6IGB1cGRhdGVDb25maWcoKWAg5pa55rOV5Y2z5bCG5bqf5byD77yM6K+35L2/55SoYHNldENvbW1hbmRCYXJzKClg5Luj5pu/YHVwZGF0ZUNvbmZpZygpYOabtOaWsGBjb21tYW5kQmFyc2DphY3nva7jgIIiKSwgWzQsIEMoZS5jb21tYW5kQmFycyldKSA6IFszLCAzXTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdC5zZW50KCksIHQubGFiZWwgPSAzOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXR1cm4gWzJdOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZXhlY3V0ZUNvbW1hbmRCYXI6IGZ1bmN0aW9uIGV4ZWN1dGVDb21tYW5kQmFyKGUpIHsKICAgICAgICByZXR1cm4gdCh0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgc3dpdGNoICh0LmxhYmVsKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBrXTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgcmV0dXJuIHQuc2VudCgpLCBDKFt7CiAgICAgICAgICAgICAgICAgIGNtYklkOiBlLAogICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICJjbGljayIsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICEwCiAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAgICB9XSksIFsyXTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIG9uOiBmdW5jdGlvbiBvbihlLCByKSB7CiAgICAgICAgcmV0dXJuIHQodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0OwogICAgICAgICAgcmV0dXJuIG4odGhpcywgZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgc3dpdGNoIChuLmxhYmVsKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBrXTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgcmV0dXJuIG4uc2VudCgpLCB0ID0gZSwgZSA9PT0gUi5maWxlU2F2ZWQgJiYgY29uc29sZS53YXJuKCJmaWxlU2F2ZWTkuovku7bnm5HlkKzljbPlsIblvIPnlKjvvIwg5o6o6I2Q5L2/55SoZmlsZVN0YXR1c+i/m+ihjOaWh+S7tueKtuaAgeeahOebkeWQrCIpLCBlID09PSBSLmZ1bGxzY3JlZW5DaGFuZ2UgJiYgKHQgPSAiZnVsbHNjcmVlbmNoYW5nZSIpLCBLKHQsICJvbiIpLCBfLm9uKGUsIHIpLCBbMl07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9LAogICAgICBvZmY6IGZ1bmN0aW9uIG9mZihlLCByKSB7CiAgICAgICAgcmV0dXJuIHQodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBuKHRoaXMsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJldHVybiBbNCwga107CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJldHVybiB0LnNlbnQoKSwgSyhlLCAib2ZmIiksIF8ub2ZmKGUsIHIpLCBbMl07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCBmdW5jdGlvbiAoZSwgdCwgbiwgciwgaSwgbykgewogICAgICB0ICYmIGEodCkgJiYgKGkucmVmcmVzaFRva2VuID0gdCwgZS5yZWZyZXNoVG9rZW4gPSB7CiAgICAgICAgZXZlbnROYW1lOiBXLmdldFRva2VuCiAgICAgIH0pOwogICAgICBvICYmIGEobykgJiYgKGkuZ2V0Q2xpcGJvYXJkRGF0YSA9IG8sIGUuZ2V0Q2xpcGJvYXJkRGF0YSA9IHsKICAgICAgICBldmVudE5hbWU6IFcuZ2V0Q2xpcGJvYXJkRGF0YQogICAgICB9KTsKICAgICAgbiAmJiBhKG4pICYmIChpLm9uVG9hc3QgPSBuLCBlLm9uVG9hc3QgPSB7CiAgICAgICAgZXZlbnROYW1lOiBXLm9uVG9hc3QKICAgICAgfSk7CiAgICAgIHIgJiYgYShyKSAmJiAoaS5vbkh5cGVyTGlua09wZW4gPSByLCBlLm9uSHlwZXJMaW5rT3BlbiA9IHsKICAgICAgICBldmVudE5hbWU6IFcub25IeXBlckxpbmtPcGVuCiAgICAgIH0pOwogICAgfShpLCBwLCBmLCB2LCBTLCBtKSwgeihNLCBfLCBpLCBzLCBTLCB5LCBPKSwgTTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmVycm9yKGUpOwogIH0KCiAgdmFyIEUsIFQsIEw7Cn0KCmZ1bmN0aW9uIEsoZSwgdCkgewogIHZhciBuID0gZTsKICBbImVycm9yIiwgImZpbGVPcGVuIl0uaW5jbHVkZXMobikgfHwgKCJmaWxlU2F2ZWQiID09PSBuICYmIChuID0gImZpbGVTdGF0dXMiKSwgaCh7CiAgICBldmVudE5hbWU6ICJiYXNpYy5ldmVudCIsCiAgICBkYXRhOiB7CiAgICAgIGV2ZW50TmFtZTogbiwKICAgICAgYWN0aW9uOiB0CiAgICB9CiAgfSkpOwp9Cgpjb25zb2xlLmxvZygiV2ViT2ZmaWNlU0RLIEpTLVNESyBWMS4xLjEyIik7CnZhciBKID0gT2JqZWN0LmZyZWV6ZSh7CiAgX19wcm90b19fOiBudWxsLAogIGxpc3RlbmVyOiB6LAogIGNvbmZpZzogRwp9KTsKd2luZG93LldQUyA9IEo7CnZhciBVID0gRzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbmZpZzogRwp9OwpleHBvcnQgeyBVIGFzIGNvbmZpZyB9Ow=="},null]}